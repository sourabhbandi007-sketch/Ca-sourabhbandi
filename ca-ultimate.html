<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>CA Sourabh Bandi Â· AI Software</title>
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#0a0e1a;
  --bg2:#111827;
  --bg3:#1a2235;
  --card:#141c2e;
  --border:#1e2d45;
  --accent:#00e5b0;
  --accent2:#7c63ff;
  --gold:#f5c542;
  --red:#ff4d6d;
  --green:#22c55e;
  --text:#e8f0fe;
  --muted:#64748b;
  --grad:linear-gradient(135deg,#00e5b0,#7c63ff);
  --grad2:linear-gradient(135deg,#7c63ff,#ff4d6d);
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html,body{height:100%;overflow-x:hidden}
body{background:var(--bg);color:var(--text);font-family:'Baloo 2','Arial',sans-serif;line-height:1.5}

/* â”€â”€ SCROLLBAR â”€â”€ */
::-webkit-scrollbar{width:4px}
::-webkit-scrollbar-track{background:var(--bg2)}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px}

/* â”€â”€ HEADER â”€â”€ */
.hdr{position:sticky;top:0;z-index:300;background:rgba(10,14,26,.95);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:10px 20px;display:flex;align-items:center;gap:12px}
.hdr-logo{width:42px;height:42px;border-radius:10px;background:var(--grad);display:flex;align-items:center;justify-content:center;font-weight:800;font-size:.9rem;color:#fff;flex-shrink:0;box-shadow:0 0 20px rgba(0,229,176,.25)}
.hdr-info h1{font-size:.95rem;font-weight:800;letter-spacing:.3px}
.hdr-info p{font-size:.65rem;color:var(--muted);margin-top:1px}
.hdr-dot{margin-left:auto;width:8px;height:8px;background:var(--green);border-radius:50%;box-shadow:0 0 8px var(--green);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}

/* â”€â”€ TOOLBAR â”€â”€ */
.tbar{background:var(--bg2);border-bottom:1px solid var(--border);padding:8px 20px;display:flex;flex-wrap:wrap;gap:6px}
.tbtn{padding:5px 12px;background:var(--bg3);border:1px solid var(--border);color:var(--text);border-radius:6px;font-size:12px;cursor:pointer;font-family:inherit;font-weight:600;transition:background .15s,border-color .15s,color .15s;white-space:nowrap;user-select:none}
.tbtn:hover{background:var(--border);color:#fff}
.tbtn:active{transform:scale(.97)}
.tbtn.t-green{background:#0a2e1a;border-color:var(--green);color:var(--green)}
.tbtn.t-red{background:#2a0f17;border-color:var(--red);color:var(--red)}
.tbtn.t-blue{background:#0e1f3d;border-color:#58a6ff;color:#58a6ff}
.tbtn.t-pulse{animation:rblink 1s infinite}
@keyframes rblink{0%,100%{box-shadow:0 0 0 0 rgba(255,77,109,.5)}50%{box-shadow:0 0 0 6px rgba(255,77,109,0)}}

/* â”€â”€ VOICE BAR â”€â”€ */
#vbar{display:none;background:#0a2218;border-bottom:1px solid var(--green);padding:8px 20px;text-align:center;color:var(--green);font-weight:700;font-size:13px;font-family:'JetBrains Mono',monospace}

/* â”€â”€ BANNER â”€â”€ */
#banner{display:none;padding:8px 20px}
.bnr{background:var(--bg3);border:1px solid var(--gold);border-radius:8px;padding:9px 14px;display:flex;align-items:center;gap:8px;font-size:12px;color:var(--gold)}
.bnr-close{background:none;border:none;color:var(--muted);font-size:16px;cursor:pointer;margin-left:auto;padding:0;line-height:1}

/* â”€â”€ MAIN WRAP â”€â”€ */
.wrap{max-width:1100px;margin:0 auto;padding:14px 18px}

/* â”€â”€ TABS â”€â”€ */
.tabs{display:flex;gap:4px;flex-wrap:wrap;background:var(--bg2);border:1px solid var(--border);border-radius:9px;padding:5px;margin-bottom:14px}
.tab{padding:6px 13px;background:none;border:none;color:var(--muted);font-size:12px;font-weight:600;cursor:pointer;border-radius:6px;font-family:inherit;transition:background .15s,color .15s;white-space:nowrap;user-select:none}
.tab:hover{background:var(--bg3);color:var(--text)}
.tab.on{background:var(--grad);color:#fff}
.tab:active{transform:scale(.97)}

/* â”€â”€ PANELS â”€â”€ */
.panel{display:none}
.panel.on{display:block}

/* â”€â”€ CARD â”€â”€ */
.card{background:var(--card);border:1px solid var(--border);border-radius:11px;padding:16px;margin-bottom:12px}
.card-title{font-size:14px;font-weight:800;margin-bottom:13px;display:flex;align-items:center;gap:7px}

/* â”€â”€ GRID â”€â”€ */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
@media(max-width:680px){.g2,.g3,.g4{grid-template-columns:1fr 1fr}}
@media(max-width:420px){.g2,.g3,.g4{grid-template-columns:1fr}}

/* â”€â”€ INPUTS â”€â”€ */
.inp{width:100%;padding:9px 12px;background:var(--bg3);border:1px solid var(--border);border-radius:7px;color:var(--text);font-size:13px;font-family:inherit;outline:none;transition:border-color .15s}
.inp:focus{border-color:var(--accent)}
select.inp option{background:var(--bg2)}
textarea.inp{resize:vertical}
label.lbl{display:block;font-size:11px;color:var(--muted);font-weight:600;margin-bottom:4px}

/* â”€â”€ BUTTONS â”€â”€ */
.btn{padding:8px 16px;border:none;border-radius:7px;cursor:pointer;font-size:13px;font-weight:700;font-family:inherit;transition:opacity .15s,transform .1s;user-select:none}
.btn:hover{opacity:.88}
.btn:active{transform:scale(.97)}
.btn.grad{background:var(--grad);color:#fff}
.btn.green{background:var(--green);color:#000}
.btn.red{background:var(--red);color:#fff}
.btn.blue{background:#58a6ff;color:#000}
.btn.gray{background:var(--bg3);border:1px solid var(--border);color:var(--text)}
.btn.sm{padding:5px 10px;font-size:11px}

/* â”€â”€ STAT CARDS â”€â”€ */
.stat{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:14px;text-align:center}
.stat-n{font-size:1.7rem;font-weight:800;margin:5px 0;font-family:'JetBrains Mono',monospace}

/* â”€â”€ RESULT BOX â”€â”€ */
.rbox{background:var(--bg);border:1px solid var(--border);border-radius:9px;padding:12px;margin-top:10px}
.rrow{display:flex;justify-content:space-between;padding:5px 0;font-size:13px;border-bottom:1px solid var(--bg3)}
.rrow:last-child{border:none;font-size:14px;font-weight:800;padding-top:8px}

/* â”€â”€ INFO BOX â”€â”€ */
.ibox{background:var(--bg3);border-left:3px solid var(--gold);border-radius:0 7px 7px 0;padding:8px 12px;font-size:12px;color:var(--gold);margin-top:8px}

/* â”€â”€ PROGRESS â”€â”€ */
.prog-w{background:var(--bg3);border-radius:5px;height:8px;overflow:hidden;margin:4px 0}
.prog-b{background:var(--grad);height:100%;border-radius:5px;transition:width .5s}

/* â”€â”€ CLIENT CARD â”€â”€ */
.ccrd{background:var(--bg3);border:1px solid var(--border);border-radius:9px;padding:11px;display:flex;align-items:center;gap:11px;margin-bottom:7px}
.av{width:44px;height:44px;border-radius:50%;border:2px solid var(--accent);background:var(--bg2);display:flex;align-items:center;justify-content:center;font-size:1.3rem;flex-shrink:0;overflow:hidden}
.av img{width:100%;height:100%;object-fit:cover}

/* â”€â”€ CALENDAR ITEM â”€â”€ */
.citem{background:var(--bg3);border-left:3px solid var(--accent);border-radius:0 7px 7px 0;padding:9px 12px;margin-bottom:7px}

/* â”€â”€ QUICK ACTION BUTTONS â”€â”€ */
.qact{background:var(--bg3);border:1px solid var(--border);border-radius:9px;padding:16px 10px;cursor:pointer;text-align:center;color:var(--text);font-family:inherit;width:100%;transition:border-color .15s,color .15s;user-select:none}
.qact:hover{border-color:var(--accent);color:var(--accent)}
.qact:active{transform:scale(.97)}
.qact span{display:block;font-size:1.6rem;margin-bottom:4px}
.qact small{font-size:11px;font-weight:700;color:var(--muted)}

/* â”€â”€ TABLE â”€â”€ */
table{width:100%;border-collapse:collapse;font-size:12px}
th{background:var(--bg3);padding:8px 10px;text-align:left;color:var(--muted);font-weight:700;border-bottom:1px solid var(--border)}
td{padding:8px 10px;border-bottom:1px solid var(--bg3)}

/* â”€â”€ DISCLAIMER â”€â”€ */
.dis{margin-top:6px;padding:6px 10px;background:var(--bg);border-left:2px solid var(--gold);font-size:10px;color:var(--gold);border-radius:0 5px 5px 0}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   CHATBOT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.fab{position:fixed;bottom:20px;right:20px;width:52px;height:52px;border-radius:50%;background:var(--grad);border:none;color:#fff;font-size:1.35rem;cursor:pointer;z-index:900;box-shadow:0 6px 24px rgba(0,229,176,.35);display:flex;align-items:center;justify-content:center;transition:transform .15s;user-select:none}
.fab:hover{transform:scale(1.08)}
.fab:active{transform:scale(.95)}

#chatbot{position:fixed;bottom:20px;right:20px;width:355px;max-height:570px;z-index:901;background:var(--card);border:1px solid var(--border);border-radius:14px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.7);flex-direction:column;display:none}

.cb-head{background:var(--bg3);border-bottom:1px solid var(--border);padding:10px 13px;display:flex;align-items:center;gap:9px}
.cb-logo{width:32px;height:32px;border-radius:7px;background:var(--grad);display:flex;align-items:center;justify-content:center;font-weight:800;font-size:.75rem;color:#fff;flex-shrink:0}
.cb-close{background:none;border:none;color:var(--muted);font-size:16px;cursor:pointer;margin-left:auto;padding:0 2px;line-height:1;transition:color .15s}
.cb-close:hover{color:var(--text)}

/* KEY BOX */
#keyBox{background:var(--bg);border-bottom:1px solid var(--border);padding:9px 12px}
#keyBox label{display:block;font-size:11px;color:var(--gold);margin-bottom:4px;font-weight:700}
.krow{display:flex;gap:5px}
.krow input{flex:1;background:var(--bg3);border:1px solid var(--border);border-radius:6px;padding:6px 9px;color:var(--text);font-size:12px;outline:none;font-family:inherit}
.krow input:focus{border-color:var(--accent)}
.krow button{background:var(--green);border:none;border-radius:6px;color:#000;padding:6px 11px;font-size:12px;font-weight:800;cursor:pointer}
#keyBox .hint{font-size:10px;color:var(--muted);margin-top:3px}

/* MESSAGES */
.cb-msgs{overflow-y:auto;padding:10px;background:var(--bg);display:flex;flex-direction:column;gap:7px;height:290px}
.cb-msgs::-webkit-scrollbar{width:3px}
.cb-msgs::-webkit-scrollbar-thumb{background:var(--border)}

.msg-bot{background:var(--card);border:1px solid var(--border);border-radius:11px;border-bottom-left-radius:3px;padding:9px 12px;font-size:12px;line-height:1.7;max-width:88%;animation:msgIn .2s ease}
.msg-user{background:var(--grad);color:#fff;border-radius:11px;border-bottom-right-radius:3px;padding:9px 12px;font-size:12px;line-height:1.6;max-width:88%;align-self:flex-end;animation:msgIn .2s ease}
.msg-lbl{font-size:10px;color:var(--accent);font-weight:700;margin-bottom:3px}
@keyframes msgIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

.typing{background:var(--card);border:1px solid var(--border);border-radius:11px;border-bottom-left-radius:3px;padding:9px 12px;display:inline-flex;gap:4px;align-items:center}
.typing span{width:6px;height:6px;background:var(--accent);border-radius:50%;animation:dot .9s infinite}
.typing span:nth-child(2){animation-delay:.15s}
.typing span:nth-child(3){animation-delay:.3s}
@keyframes dot{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}

/* FOOTER */
.cb-foot{background:var(--card);border-top:1px solid var(--border);padding:9px}
.cb-quick{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:7px}
.qbtn{background:var(--bg3);border:1px solid var(--border);color:var(--muted);border-radius:20px;padding:3px 9px;font-size:11px;cursor:pointer;font-family:inherit;font-weight:600;transition:border-color .15s,color .15s;user-select:none}
.qbtn:hover{border-color:var(--accent);color:var(--accent)}
.cb-row{display:flex;gap:6px}
.cb-in{flex:1;background:var(--bg3);border:1px solid var(--border);border-radius:7px;padding:7px 11px;color:var(--text);font-size:12px;outline:none;font-family:inherit;transition:border-color .15s}
.cb-in:focus{border-color:var(--accent)}
.cb-send{background:var(--grad);border:none;border-radius:7px;width:36px;height:36px;cursor:pointer;color:#fff;font-size:13px;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:opacity .15s}
.cb-send:disabled{opacity:.35;cursor:not-allowed}

/* â”€â”€ SMARTBOT TAB MSGS â”€â”€ */
#sbMsgs{background:var(--bg);border:1px solid var(--border);border-radius:9px;padding:10px;height:340px;overflow-y:auto;display:flex;flex-direction:column;gap:7px;margin-bottom:10px}
#sbMsgs::-webkit-scrollbar{width:3px}

/* â”€â”€ INVOICE PREVIEW â”€â”€ */
#invPrev{background:#fff;color:#111;border-radius:10px;padding:22px;margin-top:12px;font-family:Arial,sans-serif;border:1px solid var(--border);display:none}

/* â”€â”€ SCAN MODAL â”€â”€ */
.modal-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:2000;align-items:center;justify-content:center}
.modal-box{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px;max-width:480px;width:92%;max-height:88vh;overflow-y:auto}
</style>
</head>
<body>

<!-- HEADER -->
<div class="hdr">
  <div class="hdr-logo">CA</div>
  <div class="hdr-info">
    <h1>CA Sourabh Bandi Â· AI Tax Software</h1>
    <p>Income Tax Â· GST Â· ITR Â· Audit Â· Finance Â· à¤¹à¤¿à¤‚à¤¦à¥€ AI</p>
  </div>
  <div class="hdr-dot"></div>
</div>

<!-- TOOLBAR -->
<div class="tbar">
  <button class="tbtn t-green" onclick="toggleChat()">ğŸ’¬ CA SmartBot</button>
  <button class="tbtn t-red" id="voiceBtn" onclick="startVoice()">ğŸ¤ à¤†à¤µà¤¾à¤œà¤¼</button>
  <button class="tbtn t-blue" id="voutBtn" onclick="toggleVOut()">ğŸ”Š ON</button>
  <button class="tbtn" onclick="testSpeak()">ğŸ—£ï¸ à¤Ÿà¥‡à¤¸à¥à¤Ÿ</button>
  <button class="tbtn" onclick="openScan()">ğŸ“„ à¤¸à¥à¤•à¥ˆà¤¨</button>
  <button class="tbtn" onclick="aiTip()">ğŸ’¡ AI à¤¸à¥à¤à¤¾à¤µ</button>
  <button class="tbtn" onclick="window.print()">ğŸ–¨ï¸ à¤ªà¥à¤°à¤¿à¤‚à¤Ÿ</button>
</div>

<!-- VOICE STATUS BAR -->
<div id="vbar">ğŸ¤ à¤¸à¥à¤¨ à¤°à¤¹à¤¾ à¤¹à¥‚à¤‚â€¦ à¤¬à¥‹à¤²à¤¿à¤!</div>

<!-- BANNER -->
<div id="banner">
  <div class="bnr">
    <span style="font-size:1rem;flex-shrink:0">ğŸ’¡</span>
    <span id="bnrTxt"></span>
    <button class="bnr-close" onclick="hideBanner()">âœ•</button>
  </div>
</div>

<!-- MAIN CONTENT -->
<div class="wrap">

  <!-- TABS -->
  <div class="tabs" id="tabBar">
    <button class="tab on" data-tab="dash">ğŸ  à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡</button>
    <button class="tab" data-tab="smartbot">ğŸ“ CA SmartBot</button>
    <button class="tab" data-tab="clients">ğŸ‘¥ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ</button>
    <button class="tab" data-tab="taxcalc">ğŸ’° à¤Ÿà¥ˆà¤•à¥à¤¸</button>
    <button class="tab" data-tab="gst">ğŸ“‹ GST</button>
    <button class="tab" data-tab="invoice">ğŸ§¾ à¤‡à¤¨à¤µà¥‰à¤‡à¤¸</button>
    <button class="tab" data-tab="invest">ğŸ“ˆ à¤¨à¤¿à¤µà¥‡à¤¶</button>
    <button class="tab" data-tab="taxplan">ğŸ’¡ à¤ªà¥à¤²à¤¾à¤¨</button>
    <button class="tab" data-tab="calendar">ğŸ“… à¤•à¥ˆà¤²à¥‡à¤‚à¤¡à¤°</button>
    <button class="tab" data-tab="reports">ğŸ“Š à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ</button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DASHBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel on" id="p-dash">
    <div class="g4" style="margin-bottom:12px">
      <div class="stat" style="border-top:3px solid var(--accent)">
        <div style="font-size:1.8rem">ğŸ‘¥</div>
        <div class="stat-n" style="color:var(--accent)" id="dClients">0</div>
        <div style="font-size:11px;color:var(--muted)">à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ</div>
      </div>
      <div class="stat" style="border-top:3px solid var(--green)">
        <div style="font-size:1.8rem">ğŸ§¾</div>
        <div class="stat-n" style="color:var(--green)" id="dInvoices">0</div>
        <div style="font-size:11px;color:var(--muted)">à¤‡à¤¨à¤µà¥‰à¤‡à¤¸</div>
      </div>
      <div class="stat" style="border-top:3px solid var(--gold)">
        <div style="font-size:1.8rem">ğŸ’°</div>
        <div class="stat-n" style="color:var(--gold);font-size:1.2rem" id="dRevenue">â‚¹0</div>
        <div style="font-size:11px;color:var(--muted)">à¤†à¤¯</div>
      </div>
      <div class="stat" style="border-top:3px solid var(--accent2)">
        <div style="font-size:1.8rem">ğŸ›¡ï¸</div>
        <div class="stat-n" style="color:var(--accent2);font-size:1.2rem" id="dSaved">â‚¹0</div>
        <div style="font-size:11px;color:var(--muted)">à¤Ÿà¥ˆà¤•à¥à¤¸ à¤¬à¤šà¤¤</div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">âš¡ à¤¤à¥à¤µà¤°à¤¿à¤¤ à¤•à¤¾à¤°à¥à¤¯</div>
      <div class="g4">
        <button class="qact" onclick="goTab('clients')"><span>ğŸ‘¤</span><small>à¤¨à¤¯à¤¾ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ</small></button>
        <button class="qact" onclick="goTab('invoice')"><span>ğŸ§¾</span><small>à¤‡à¤¨à¤µà¥‰à¤‡à¤¸</small></button>
        <button class="qact" onclick="goTab('taxplan')"><span>ğŸ’¡</span><small>à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨</small></button>
        <button class="qact" onclick="goTab('smartbot')"><span>ğŸ“</span><small>CA SmartBot</small></button>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ğŸ¤ à¤†à¤µà¤¾à¤œà¤¼ à¤•à¤®à¤¾à¤‚à¤¡ (Chrome à¤®à¥‡à¤‚ à¤¬à¥‹à¤²à¥‡à¤‚)</div>
      <div class="g2">
        <div style="font-size:12px;color:var(--muted);line-height:2.2">
          "à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤¦à¤¿à¤–à¤¾à¤“" Â· "à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ à¤¬à¤¨à¤¾à¤“"<br>
          "à¤Ÿà¥ˆà¤•à¥à¤¸ à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿ à¤•à¤°à¥‹" Â· "GST à¤–à¥‹à¤²à¥‹"<br>
          "à¤¨à¤¿à¤µà¥‡à¤¶ à¤¦à¤¿à¤–à¤¾à¤“" Â· "à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡ à¤šà¤²à¥‹"
        </div>
        <div style="font-size:12px;color:var(--muted);line-height:2.2">
          "smartbot à¤–à¥‹à¤²à¥‹" Â· "à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ à¤¦à¤¿à¤–à¤¾à¤“"<br>
          "à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨ à¤¬à¤¨à¤¾à¤“"<br>
          "à¤•à¥ˆà¤²à¥‡à¤‚à¤¡à¤° à¤¦à¤¿à¤–à¤¾à¤“"
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CA SMARTBOT TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-smartbot">
    <div class="card">
      <div class="card-title">ğŸ“ CA SmartBot â€” Tax & Finance Expert</div>
      <p style="font-size:12px;color:var(--muted);margin-bottom:11px">Income Tax Â· GST Â· ITR Â· TDS Â· Audit â€” à¤¹à¤¿à¤‚à¤¦à¥€/English à¤®à¥‡à¤‚ à¤ªà¥‚à¤›à¥‡à¤‚</p>
      <div style="display:flex;flex-wrap:wrap;gap:5px;margin-bottom:12px">
        <button class="tbtn" onclick="sbQ('Income Tax slabs 2024-25?')">ğŸ“Š Tax Slabs</button>
        <button class="tbtn" onclick="sbQ('GST à¤•à¥à¤¯à¤¾ à¤¹à¥ˆ?')">ğŸ§¾ GST</button>
        <button class="tbtn" onclick="sbQ('ITR à¤•à¥ˆà¤¸à¥‡ file à¤•à¤°à¥‡à¤‚?')">ğŸ“ ITR</button>
        <button class="tbtn" onclick="sbQ('80C à¤®à¥‡à¤‚ à¤•à¥à¤¯à¤¾ à¤•à¤°à¥‡à¤‚?')">ğŸ’° 80C</button>
        <button class="tbtn" onclick="sbQ('TDS à¤•à¥à¤¯à¤¾ à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆ?')">ğŸ¦ TDS</button>
        <button class="tbtn" onclick="sbQ('Audit à¤•à¤¬ à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆ?')">ğŸ” Audit</button>
        <button class="tbtn" onclick="sbQ('New vs Old Tax Regime?')">âš–ï¸ Regime</button>
        <button class="tbtn" onclick="sbQ('Capital Gains Tax?')">ğŸ“ˆ Capital Gains</button>
        <button class="tbtn" onclick="sbQ('Home Loan tax benefit?')">ğŸ  Home Loan</button>
        <button class="tbtn" onclick="sbQ('PAN Card à¤•à¥à¤¯à¥‹à¤‚ à¤œà¤°à¥‚à¤°à¥€?')">ğŸªª PAN</button>
      </div>
      <div id="sbMsgs">
        <div class="msg-bot">
          <div class="msg-lbl">ğŸ“ CA SmartBot</div>
          à¤¨à¤®à¤¸à¥à¤¤à¥‡! Tax, GST, ITR à¤”à¤° Finance à¤•à¥‡ à¤¸à¤µà¤¾à¤² à¤ªà¥‚à¤›à¥‡à¤‚à¥¤ à¤Šà¤ªà¤° topic à¤šà¥à¤¨à¥‡à¤‚ à¤¯à¤¾ à¤¨à¥€à¤šà¥‡ à¤²à¤¿à¤–à¥‡à¤‚!
        </div>
      </div>
      <div style="display:flex;gap:7px">
        <input class="inp" id="sbIn" placeholder="Tax, GST, ITR à¤ªà¥‚à¤›à¥‡à¤‚..." onkeydown="if(event.key==='Enter')sbSend()"/>
        <button class="btn grad" onclick="sbSend()">à¤ªà¥‚à¤›à¥‡à¤‚ â¤</button>
      </div>
      <div style="font-size:10px;color:var(--muted);margin-top:6px;text-align:center">âš ï¸ Educational only â€” Official advice à¤•à¥‡ à¤²à¤¿à¤ CA à¤¸à¥‡ à¤®à¤¿à¤²à¥‡à¤‚</div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CLIENTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-clients">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:11px;flex-wrap:wrap;gap:7px">
        <div class="card-title" style="margin:0">ğŸ‘¥ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤ªà¥à¤°à¤¬à¤‚à¤§à¤¨</div>
        <button class="btn grad sm" onclick="showCF()">â• à¤¨à¤¯à¤¾ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ</button>
      </div>
      <input class="inp" id="csrch" placeholder="ğŸ” à¤¨à¤¾à¤® à¤¯à¤¾ PAN à¤¸à¥‡ à¤–à¥‹à¤œà¥‡à¤‚â€¦" oninput="srchC()" style="margin-bottom:10px"/>
      <div id="cList"></div>
    </div>
    <div id="cForm" class="card" style="display:none">
      <div class="card-title">âœï¸ à¤¨à¤¯à¤¾ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚</div>
      <div style="display:flex;align-items:center;gap:13px;margin-bottom:13px">
        <div style="position:relative">
          <div id="photoBox" style="width:64px;height:64px;border-radius:50%;border:2px solid var(--accent);background:var(--bg3);display:flex;align-items:center;justify-content:center;font-size:1.8rem;overflow:hidden">ğŸ‘¤</div>
          <button onclick="document.getElementById('photoIn').click()" style="position:absolute;bottom:0;right:0;background:var(--accent);border:none;border-radius:50%;width:20px;height:20px;cursor:pointer;font-size:9px;color:#000;display:flex;align-items:center;justify-content:center">ğŸ“·</button>
          <input type="file" id="photoIn" accept="image/*" style="display:none" onchange="prevPhoto(event)"/>
        </div>
        <button class="btn gray sm" onclick="document.getElementById('photoIn').click()">ğŸ“¤ à¤«à¥‹à¤Ÿà¥‹ à¤…à¤ªà¤²à¥‹à¤¡</button>
      </div>
      <div class="g2">
        <div><label class="lbl">à¤¨à¤¾à¤® *</label><input class="inp" id="cName" placeholder="à¤ªà¥‚à¤°à¤¾ à¤¨à¤¾à¤®"/></div>
        <div><label class="lbl">PAN *</label><input class="inp" id="cPAN" placeholder="ABCDE1234F" maxlength="10" oninput="this.value=this.value.toUpperCase();chkPAN(this)"/><span id="panMsg" style="font-size:10px"></span></div>
        <div><label class="lbl">GST</label><input class="inp" id="cGST" placeholder="27ABCDE1234F1Z5" oninput="this.value=this.value.toUpperCase();chkGST(this)"/><span id="gstMsg" style="font-size:10px"></span></div>
        <div><label class="lbl">à¤ˆà¤®à¥‡à¤²</label><input class="inp" id="cEmail" type="email" placeholder="email@example.com"/></div>
        <div><label class="lbl">à¤«à¥‹à¤¨</label><input class="inp" id="cPhone" type="tel" placeholder="9876543210"/></div>
        <div><label class="lbl">à¤µà¥à¤¯à¤µà¤¸à¤¾à¤¯</label><select class="inp" id="cBiz"><option>à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤</option><option>à¤¸à¥à¤µà¤¾à¤®à¤¿à¤¤à¥à¤µ</option><option>à¤¸à¤¾à¤à¥‡à¤¦à¤¾à¤°à¥€</option><option>LLP</option><option>Pvt Ltd</option></select></div>
        <div style="grid-column:span 2"><label class="lbl">à¤ªà¤¤à¤¾</label><textarea class="inp" id="cAddr" rows="2" placeholder="à¤ªà¥‚à¤°à¤¾ à¤ªà¤¤à¤¾"></textarea></div>
      </div>
      <div style="display:flex;gap:7px;margin-top:12px">
        <button class="btn grad" onclick="saveC()">ğŸ’¾ à¤¸à¥‡à¤µ à¤•à¤°à¥‡à¤‚</button>
        <button class="btn gray" onclick="hideCF()">âŒ à¤°à¤¦à¥à¤¦</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAX CALC â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-taxcalc">
    <div class="g2">
      <div class="card">
        <div class="card-title">ğŸ’° à¤†à¤¯à¤•à¤° à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿà¤°</div>
        <div style="display:flex;flex-direction:column;gap:10px">
          <div><label class="lbl">à¤µà¤¾à¤°à¥à¤·à¤¿à¤• à¤†à¤¯ (â‚¹)</label><input class="inp" type="number" id="tcInc" placeholder="800000" oninput="regTip()"/></div>
          <div id="regTipBox" class="ibox" style="display:none"></div>
          <div><label class="lbl">à¤•à¤° à¤µà¥à¤¯à¤µà¤¸à¥à¤¥à¤¾</label>
            <select class="inp" id="tcReg" onchange="document.getElementById('dedRow').style.display=this.value==='new'?'none':'block'">
              <option value="old">à¤ªà¥à¤°à¤¾à¤¨à¥€ (à¤•à¤Ÿà¥Œà¤¤à¥€ à¤¸à¤¹à¤¿à¤¤)</option>
              <option value="new">à¤¨à¤ˆ (à¤¸à¤°à¤² â€” â‚¹7L à¤¤à¤• zero)</option>
            </select>
          </div>
          <div id="dedRow"><label class="lbl">à¤•à¤Ÿà¥Œà¤¤à¥€ 80C/80D (â‚¹)</label><input class="inp" type="number" id="tcDed" placeholder="0"/></div>
          <button class="btn grad" onclick="calcTax()">ğŸ¤– à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚</button>
        </div>
        <div id="taxRes" style="display:none" class="rbox">
          <div class="rrow"><span>à¤•à¥à¤² à¤†à¤¯</span><span id="rGross"></span></div>
          <div class="rrow"><span>à¤•à¤° à¤¯à¥‹à¤—à¥à¤¯</span><span id="rTaxable"></span></div>
          <div class="rrow"><span>à¤†à¤¯à¤•à¤°</span><span id="rTax" style="color:var(--red)"></span></div>
          <div class="rrow"><span>à¤‰à¤ªà¤•à¤° 4%</span><span id="rCess"></span></div>
          <div class="rrow"><span style="color:var(--red)">à¤•à¥à¤² à¤¦à¥‡à¤¯</span><span id="rTotal" style="color:var(--red)"></span></div>
          <div class="ibox" id="taxTip" style="margin-top:8px"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ“Š TDS à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿà¤°</div>
        <div style="display:flex;flex-direction:column;gap:10px">
          <div><label class="lbl">à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤°à¤¾à¤¶à¤¿ (â‚¹)</label><input class="inp" type="number" id="tdsAmt" placeholder="0"/></div>
          <div><label class="lbl">TDS à¤§à¤¾à¤°à¤¾</label>
            <select class="inp" id="tdsSec">
              <option value="1">194C â€” à¤ à¥‡à¤•à¤¾ à¤µà¥à¤¯à¤•à¥à¤¤à¤¿ (1%)</option>
              <option value="2">194C â€” à¤ à¥‡à¤•à¤¾ à¤•à¤‚à¤ªà¤¨à¥€ (2%)</option>
              <option value="10">194J â€” à¤ªà¥‡à¤¶à¥‡à¤µà¤° / CA (10%)</option>
              <option value="5">194H â€” à¤•à¤®à¥€à¤¶à¤¨ (5%)</option>
              <option value="10">194I â€” à¤•à¤¿à¤°à¤¾à¤¯à¤¾ à¤­à¥‚à¤®à¤¿ (10%)</option>
              <option value="2">194I â€” à¤•à¤¿à¤°à¤¾à¤¯à¤¾ à¤®à¤¶à¥€à¤¨ (2%)</option>
              <option value="10">194A â€” à¤¬à¥à¤¯à¤¾à¤œ (10%)</option>
            </select>
          </div>
          <button class="btn grad" onclick="calcTDS()">ğŸ¤– TDS à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿ</button>
        </div>
        <div id="tdsRes" style="display:none" class="rbox">
          <div class="rrow"><span>à¤­à¥à¤—à¤¤à¤¾à¤¨</span><span id="tAmt"></span></div>
          <div class="rrow"><span>TDS à¤¦à¤°</span><span id="tRate"></span></div>
          <div class="rrow"><span style="color:var(--red)">TDS à¤•à¤¾à¤Ÿà¥€</span><span id="tTDS" style="color:var(--red)"></span></div>
          <div class="rrow"><span style="color:var(--green)">à¤¶à¥à¤¦à¥à¤§ à¤­à¥à¤—à¤¤à¤¾à¤¨</span><span id="tNet" style="color:var(--green)"></span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-gst">
    <div class="g2">
      <div class="card">
        <div class="card-title">ğŸ“‹ GST à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿà¤°</div>
        <div style="display:flex;flex-direction:column;gap:10px">
          <div><label class="lbl">à¤°à¤¾à¤¶à¤¿ à¤ªà¥à¤°à¤•à¤¾à¤°</label><select class="inp" id="gType"><option value="ex">Exclusive (GST à¤œà¥‹à¤¡à¤¼à¥‡à¤‚)</option><option value="in">Inclusive (GST à¤¨à¤¿à¤•à¤¾à¤²à¥‡à¤‚)</option></select></div>
          <div><label class="lbl">à¤°à¤¾à¤¶à¤¿ (â‚¹)</label><input class="inp" type="number" id="gAmt" placeholder="0"/></div>
          <div><label class="lbl">GST à¤¦à¤°</label><select class="inp" id="gRate"><option value="0">0%</option><option value="5">5%</option><option value="12">12%</option><option value="18" selected>18%</option><option value="28">28%</option></select></div>
          <button class="btn grad" onclick="calcGST()">ğŸ¤– à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿ</button>
        </div>
        <div id="gstRes" style="display:none" class="rbox">
          <div class="rrow"><span>à¤†à¤§à¤¾à¤° à¤°à¤¾à¤¶à¤¿</span><span id="gBase"></span></div>
          <div class="rrow"><span>CGST (<span id="gCR"></span>%)</span><span id="gCGST"></span></div>
          <div class="rrow"><span>SGST (<span id="gSR"></span>%)</span><span id="gSGST"></span></div>
          <div class="rrow"><span style="color:var(--accent)">à¤•à¥à¤² à¤°à¤¾à¤¶à¤¿</span><span id="gTotal" style="color:var(--accent)"></span></div>
        </div>
      </div>
      <div class="card">
        <div class="card-title">ğŸ“… GST à¤¡à¥‡à¤¡à¤²à¤¾à¤‡à¤¨</div>
        <div class="citem" style="border-color:var(--gold)"><div style="font-weight:700">GSTR-1</div><div style="font-size:11px;color:var(--muted)">à¤…à¤—à¤²à¥‡ à¤®à¤¾à¤¹ à¤•à¥€ 11 à¤¤à¤¾à¤°à¥€à¤–</div></div>
        <div class="citem" style="border-color:var(--red)"><div style="font-weight:700">GSTR-3B</div><div style="font-size:11px;color:var(--muted)">à¤…à¤—à¤²à¥‡ à¤®à¤¾à¤¹ à¤•à¥€ 20 à¤¤à¤¾à¤°à¥€à¤–</div></div>
        <div class="citem" style="border-color:var(--accent2)"><div style="font-weight:700">GSTR-9 (à¤µà¤¾à¤°à¥à¤·à¤¿à¤•)</div><div style="font-size:11px;color:var(--muted)">31 à¤¦à¤¿à¤¸à¤‚à¤¬à¤°</div></div>
        <div class="ibox" style="margin-top:10px">âš ï¸ à¤¦à¥‡à¤°à¥€ à¤ªà¤° â‚¹50/à¤¦à¤¿à¤¨ à¤œà¥à¤°à¥à¤®à¤¾à¤¨à¤¾!</div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• INVOICE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-invoice">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:11px">
        <div class="card-title" style="margin:0">ğŸ§¾ AI à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ à¤œà¥‡à¤¨à¤°à¥‡à¤Ÿà¤°</div>
        <button class="btn grad sm" onclick="quickInv()">ğŸ¤– à¤¤à¥à¤µà¤°à¤¿à¤¤</button>
      </div>
      <div class="g2" style="margin-bottom:10px">
        <div><label class="lbl">à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ *</label><select class="inp" id="iClient"><option value="">â€” à¤šà¥à¤¨à¥‡à¤‚ â€”</option></select></div>
        <div><label class="lbl">à¤¤à¤¾à¤°à¥€à¤– *</label><input class="inp" type="date" id="iDate"/></div>
        <div><label class="lbl">à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ à¤¨à¤‚à¤¬à¤° *</label><input class="inp" id="iNum" placeholder="INV-0001"/></div>
        <div><label class="lbl">à¤¦à¥‡à¤¯ à¤¤à¤¿à¤¥à¤¿</label><input class="inp" type="date" id="iDue"/></div>
      </div>
      <div style="border:1px solid var(--border);border-radius:9px;padding:11px;margin-bottom:10px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <div style="font-size:13px;font-weight:700">à¤¸à¥‡à¤µà¤¾à¤à¤‚ / à¤µà¤¸à¥à¤¤à¥à¤à¤‚</div>
          <button class="btn grad sm" onclick="addItem()">â• à¤œà¥‹à¤¡à¤¼à¥‡à¤‚</button>
        </div>
        <div id="iItems"></div>
      </div>
      <div class="rbox" style="margin-bottom:10px">
        <div class="rrow"><span>à¤‰à¤ª-à¤•à¥à¤²</span><span id="iSub">â‚¹0.00</span></div>
        <div class="rrow"><span>GST 18%</span><span id="iGST">â‚¹0.00</span></div>
        <div class="rrow"><span style="color:var(--accent)">à¤•à¥à¤²</span><span id="iTotal" style="color:var(--accent)">â‚¹0.00</span></div>
      </div>
      <div style="display:flex;gap:7px;flex-wrap:wrap">
        <button class="btn grad" onclick="genInv()">ğŸ“„ à¤¬à¤¨à¤¾à¤à¤‚</button>
        <button class="btn blue" onclick="printInv()">ğŸ–¨ï¸ à¤ªà¥à¤°à¤¿à¤‚à¤Ÿ</button>
        <button class="btn gray" onclick="resetInv()">ğŸ”„ à¤°à¥€à¤¸à¥‡à¤Ÿ</button>
      </div>
    </div>
    <div id="invPrev"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• INVEST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-invest">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:11px">
        <div class="card-title" style="margin:0">ğŸ“ˆ à¤¨à¤¿à¤µà¥‡à¤¶ à¤Ÿà¥à¤°à¥ˆà¤•à¤°</div>
        <button class="btn grad sm" onclick="document.getElementById('invForm').style.display='block'">â• à¤œà¥‹à¤¡à¤¼à¥‡à¤‚</button>
      </div>
      <div style="margin-bottom:12px">
        <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:3px;font-weight:700">
          <span>Section 80C</span><span><span id="inv80C" style="color:var(--accent)">â‚¹0</span> / â‚¹1,50,000</span>
        </div>
        <div class="prog-w"><div class="prog-b" id="prog80C" style="width:0%"></div></div>
      </div>
      <div class="g3" style="margin-bottom:12px">
        <div class="stat" style="padding:11px"><div style="font-size:10px;color:var(--muted)">80D à¤¬à¥€à¤®à¤¾</div><div style="font-size:1.1rem;font-weight:800;color:var(--accent2)" id="inv80D">â‚¹0</div></div>
        <div class="stat" style="padding:11px"><div style="font-size:10px;color:var(--muted)">NPS 80CCD</div><div style="font-size:1.1rem;font-weight:800;color:var(--accent)" id="invNPS">â‚¹0</div></div>
        <div class="stat" style="padding:11px"><div style="font-size:10px;color:var(--muted)">à¤•à¥à¤² à¤¬à¤šà¤¤</div><div style="font-size:1.1rem;font-weight:800;color:var(--gold)" id="taxSaved">â‚¹0</div></div>
      </div>
      <div id="invList"></div>
    </div>
    <div id="invForm" class="card" style="display:none">
      <div class="card-title">à¤¨à¤¯à¤¾ à¤¨à¤¿à¤µà¥‡à¤¶ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚</div>
      <div class="g2">
        <div><label class="lbl">à¤ªà¥à¤°à¤•à¤¾à¤° *</label>
          <select class="inp" id="invType" onchange="showInvInfo()">
            <option value="">â€” à¤šà¥à¤¨à¥‡à¤‚ â€”</option>
            <optgroup label="80C (â‚¹1.5L)"><option value="ppf-80c">PPF</option><option value="elss-80c">ELSS</option><option value="lic-80c">LIC</option><option value="nsc-80c">NSC</option><option value="fd-80c">Tax Saver FD</option></optgroup>
            <optgroup label="80D"><option value="health-80d">à¤¸à¥à¤µà¤¾à¤¸à¥à¤¥à¥à¤¯ à¤¬à¥€à¤®à¤¾</option></optgroup>
            <optgroup label="80CCD(1B)"><option value="nps-80ccd">NPS</option></optgroup>
          </select>
        </div>
        <div><label class="lbl">à¤°à¤¾à¤¶à¤¿ (â‚¹) *</label><input class="inp" type="number" id="invAmt" placeholder="50000"/></div>
        <div><label class="lbl">à¤¤à¤¾à¤°à¥€à¤–</label><input class="inp" type="date" id="invDt"/></div>
        <div><label class="lbl">à¤¨à¥‹à¤Ÿ</label><input class="inp" id="invNote" placeholder="à¤µà¥ˆà¤•à¤²à¥à¤ªà¤¿à¤•"/></div>
        <div id="invInfoBox" style="display:none;grid-column:span 2" class="ibox"></div>
      </div>
      <div style="display:flex;gap:7px;margin-top:11px">
        <button class="btn grad" onclick="saveInv()">ğŸ’¾ à¤¸à¥‡à¤µ</button>
        <button class="btn gray" onclick="document.getElementById('invForm').style.display='none'">âŒ à¤°à¤¦à¥à¤¦</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAX PLAN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-taxplan">
    <div class="card">
      <div class="card-title">ğŸ’¡ AI à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨à¤¿à¤‚à¤—</div>
      <div class="g2">
        <div><label class="lbl">à¤µà¤¾à¤°à¥à¤·à¤¿à¤• à¤†à¤¯ (â‚¹)</label><input class="inp" id="pInc" placeholder="800000"/></div>
        <div><label class="lbl">à¤†à¤¯à¥</label><input class="inp" type="number" id="pAge" placeholder="30"/></div>
        <div><label class="lbl">à¤®à¤¾à¤¸à¤¿à¤• à¤•à¤¿à¤°à¤¾à¤¯à¤¾ (â‚¹)</label><input class="inp" type="number" id="pRent" placeholder="15000"/></div>
        <div>
          <label class="lbl">à¤—à¥ƒà¤¹ à¤‹à¤£?</label>
          <select class="inp" id="pLoan" onchange="document.getElementById('loanRow').style.display=this.value==='yes'?'block':'none'">
            <option value="no">à¤¨à¤¹à¥€à¤‚</option><option value="yes">à¤¹à¤¾à¤</option>
          </select>
        </div>
        <div id="loanRow" style="display:none"><label class="lbl">à¤‹à¤£ à¤¬à¥à¤¯à¤¾à¤œ à¤µà¤¾à¤°à¥à¤·à¤¿à¤• (â‚¹)</label><input class="inp" type="number" id="pLInt" placeholder="200000"/></div>
        <div><label class="lbl">à¤®à¤¾à¤¤à¤¾-à¤ªà¤¿à¤¤à¤¾ 60+?</label><select class="inp" id="pPar"><option value="no">à¤¨à¤¹à¥€à¤‚</option><option value="yes">à¤¹à¤¾à¤</option></select></div>
        <div><label class="lbl">à¤œà¥‹à¤–à¤¿à¤® à¤•à¥à¤·à¤®à¤¤à¤¾</label><select class="inp" id="pRisk"><option value="low">à¤•à¤® (à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤)</option><option value="mid">à¤®à¤§à¥à¤¯à¤®</option><option value="high">à¤…à¤§à¤¿à¤•</option></select></div>
      </div>
      <button class="btn grad" onclick="genPlan()" style="margin-top:12px;width:100%;padding:11px;font-size:14px">ğŸ¤– à¤®à¥‡à¤°à¤¾ à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨ à¤¬à¤¨à¤¾à¤à¤‚</button>
    </div>
    <div id="planOut"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CALENDAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-calendar">
    <div class="card">
      <div class="card-title">ğŸ“… à¤Ÿà¥ˆà¤•à¥à¤¸ à¤…à¤¨à¥à¤ªà¤¾à¤²à¤¨ à¤•à¥ˆà¤²à¥‡à¤‚à¤¡à¤°</div>
      <div style="background:#1a0f0f;border:1px solid var(--red);border-radius:9px;padding:12px;margin-bottom:12px">
        <div style="font-weight:800;color:var(--red);font-size:12px;margin-bottom:5px">âš ï¸ à¤‡à¤¸ à¤®à¤¾à¤¹ à¤•à¥€ à¤¸à¤®à¤¯à¤¸à¥€à¤®à¤¾à¤à¤‚</div>
        <div id="calDL" style="font-size:12px;color:var(--muted);line-height:2.2"></div>
      </div>
      <div class="citem"><div style="font-weight:700">GSTR-1 (à¤®à¤¾à¤¸à¤¿à¤•)</div><div style="font-size:11px;color:var(--muted)">11 à¤¤à¤¾à¤°à¥€à¤– â€” à¤¬à¤¿à¤•à¥à¤°à¥€ à¤‡à¤¨à¤µà¥‰à¤‡à¤¸</div></div>
      <div class="citem" style="border-color:var(--red)"><div style="font-weight:700">GSTR-3B (à¤®à¤¾à¤¸à¤¿à¤•)</div><div style="font-size:11px;color:var(--muted)">20 à¤¤à¤¾à¤°à¥€à¤– â€” à¤Ÿà¥ˆà¤•à¥à¤¸ à¤­à¥à¤—à¤¤à¤¾à¤¨</div></div>
      <div class="citem" style="border-color:var(--red)"><div style="font-weight:700">ITR Filing (à¤µà¤¾à¤°à¥à¤·à¤¿à¤•)</div><div style="font-size:11px;color:var(--muted)">31 à¤œà¥à¤²à¤¾à¤ˆ â€” â‚¹5,000 late fee</div></div>
      <div class="citem" style="border-color:var(--gold)"><div style="font-weight:700">TDS à¤°à¤¿à¤Ÿà¤°à¥à¤¨ Q1</div><div style="font-size:11px;color:var(--muted)">31 à¤œà¥à¤²à¤¾à¤ˆ</div></div>
      <div class="citem" style="border-color:var(--accent2)"><div style="font-weight:700">Tax Saving Investments</div><div style="font-size:11px;color:var(--muted)">31 à¤®à¤¾à¤°à¥à¤š à¤¤à¤• â€” 80C/80D/NPS</div></div>
      <div class="citem" style="border-color:var(--accent2)"><div style="font-weight:700">GSTR-9 (à¤µà¤¾à¤°à¥à¤·à¤¿à¤•)</div><div style="font-size:11px;color:var(--muted)">31 à¤¦à¤¿à¤¸à¤‚à¤¬à¤°</div></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• REPORTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="panel" id="p-reports">
    <div class="card">
      <div class="card-title">ğŸ“Š AI à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ</div>
      <div class="g3">
        <button onclick="rptClient()" style="background:var(--bg3);border:1px solid var(--border);border-radius:9px;padding:16px 10px;cursor:pointer;text-align:left;color:var(--text);font-family:inherit;transition:border-color .15s" onmouseover="this.style.borderColor='var(--accent)'" onmouseout="this.style.borderColor='var(--border)'">
          <div style="font-size:1.8rem;margin-bottom:5px">ğŸ‘¥</div><div style="font-weight:700;font-size:12px">à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ</div>
        </button>
        <button onclick="rptInvoice()" style="background:var(--bg3);border:1px solid var(--border);border-radius:9px;padding:16px 10px;cursor:pointer;text-align:left;color:var(--text);font-family:inherit;transition:border-color .15s" onmouseover="this.style.borderColor='var(--green)'" onmouseout="this.style.borderColor='var(--border)'">
          <div style="font-size:1.8rem;margin-bottom:5px">ğŸ§¾</div><div style="font-weight:700;font-size:12px">à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ</div>
        </button>
        <button onclick="rptTax()" style="background:var(--bg3);border:1px solid var(--border);border-radius:9px;padding:16px 10px;cursor:pointer;text-align:left;color:var(--text);font-family:inherit;transition:border-color .15s" onmouseover="this.style.borderColor='var(--gold)'" onmouseout="this.style.borderColor='var(--border)'">
          <div style="font-size:1.8rem;margin-bottom:5px">ğŸ’¡</div><div style="font-weight:700;font-size:12px">à¤Ÿà¥ˆà¤•à¥à¤¸ à¤‘à¤ªà¥à¤Ÿà¤¿à¤®à¤¾à¤‡à¤œà¤¼</div>
        </button>
      </div>
      <div id="rptOut" style="margin-top:12px"></div>
    </div>
  </div>

</div><!-- end .wrap -->

<!-- FAB -->
<button class="fab" id="fab" onclick="toggleChat()">ğŸ’¬</button>

<!-- CHATBOT -->
<div id="chatbot">
  <div class="cb-head">
    <div class="cb-logo">CA</div>
    <div>
      <div style="font-weight:800;font-size:13px">SourabhBandi CA ğŸ¤–</div>
      <div style="font-size:10px;color:var(--muted)">Gemini AI Â· Tax Â· GST Â· ITR</div>
    </div>
    <button class="cb-close" onclick="toggleChat()">âœ•</button>
  </div>
  <div id="keyBox">
    <label>ğŸ”‘ Gemini API Key (à¤à¤• à¤¬à¤¾à¤° à¤¡à¤¾à¤²à¥‡à¤‚)</label>
    <div class="krow">
      <input type="password" id="gKey" placeholder="AIzaâ€¦"/>
      <button onclick="saveKey()">Save</button>
    </div>
    <div class="hint">ğŸ”’ Key à¤¸à¤¿à¤°à¥à¤« à¤†à¤ªà¤•à¥‡ browser à¤®à¥‡à¤‚ à¤°à¤¹à¥‡à¤—à¥€à¥¤</div>
  </div>
  <div class="cb-msgs" id="cbMsgs">
    <div class="msg-bot"><div class="msg-lbl">ğŸ¤– SourabhBandi CA</div>à¤¨à¤®à¤¸à¥à¤¤à¥‡! Gemini AI à¤¸à¥‡ powered à¤¹à¥‚à¤‚à¥¤ Tax, GST, ITR à¤•à¥à¤› à¤­à¥€ à¤ªà¥‚à¤›à¥‡à¤‚!</div>
  </div>
  <div class="cb-foot">
    <div class="cb-quick">
      <button class="qbtn" onclick="qAsk('à¤Ÿà¥ˆà¤•à¥à¤¸ à¤¬à¤šà¤¾à¤¨à¥‡ à¤•à¥‡ à¤¤à¤°à¥€à¤•à¥‡')">ğŸ’° à¤Ÿà¥ˆà¤•à¥à¤¸</button>
      <button class="qbtn" onclick="qAsk('GST deadline 2024')">ğŸ“‹ GST</button>
      <button class="qbtn" onclick="qAsk('TDS à¤¦à¤°à¥‡à¤‚ à¤¬à¤¤à¤¾à¤“')">ğŸ¦ TDS</button>
      <button class="qbtn" onclick="qAsk('80C à¤®à¥‡à¤‚ à¤•à¤¹à¤¾à¤ invest à¤•à¤°à¥‡à¤‚')">ğŸ“ˆ 80C</button>
    </div>
    <div class="cb-row">
      <input class="cb-in" id="cbIn" placeholder="à¤¹à¤¿à¤‚à¤¦à¥€ à¤®à¥‡à¤‚ à¤ªà¥‚à¤›à¥‡à¤‚â€¦" onkeydown="if(event.key==='Enter')sendMsg()"/>
      <button class="cb-send" id="cbSend" onclick="sendMsg()">â¤</button>
    </div>
  </div>
</div>

<!-- SCAN MODAL -->
<div class="modal-bg" id="scanModal">
  <div class="modal-box">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <div class="card-title" style="margin:0">ğŸ“„ AI à¤¦à¤¸à¥à¤¤à¤¾à¤µà¥‡à¤œà¤¼ à¤¸à¥à¤•à¥ˆà¤¨à¤°</div>
      <button onclick="closeScan()" style="background:none;border:none;color:var(--muted);font-size:17px;cursor:pointer">âœ•</button>
    </div>
    <select class="inp" id="docType" style="margin-bottom:10px">
      <option value="auto">ğŸ¤– AI à¤¸à¥à¤µà¤¤à¤ƒ à¤ªà¤¹à¤šà¤¾à¤¨à¥‡à¤‚</option>
      <option value="pan">PAN à¤•à¤¾à¤°à¥à¤¡</option>
      <option value="aadhaar">à¤†à¤§à¤¾à¤° à¤•à¤¾à¤°à¥à¤¡</option>
      <option value="gst">GST à¤ªà¥à¤°à¤®à¤¾à¤£à¤ªà¤¤à¥à¤°</option>
      <option value="invoice">à¤‡à¤¨à¤µà¥‰à¤‡à¤¸</option>
      <option value="bank">à¤¬à¥ˆà¤‚à¤• à¤¸à¥à¤Ÿà¥‡à¤Ÿà¤®à¥‡à¤‚à¤Ÿ</option>
    </select>
    <div style="border:2px dashed var(--border);border-radius:9px;padding:28px;text-align:center;margin-bottom:10px">
      <div style="font-size:2.5rem;margin-bottom:8px">ğŸ“¤</div>
      <div style="font-weight:700;margin-bottom:5px">à¤¦à¤¸à¥à¤¤à¤¾à¤µà¥‡à¤œà¤¼ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚</div>
      <div style="font-size:11px;color:var(--muted);margin-bottom:12px">AI à¤¸à¥à¤µà¤¤à¤ƒ à¤¡à¥‡à¤Ÿà¤¾ à¤¨à¤¿à¤•à¤¾à¤²à¥‡à¤—à¤¾</div>
      <input type="file" id="scanFile" accept="image/*" style="display:none" onchange="runScan()"/>
      <button class="btn grad" onclick="document.getElementById('scanFile').click()">ğŸ“· à¤«à¥‹à¤Ÿà¥‹ à¤šà¥à¤¨à¥‡à¤‚</button>
    </div>
    <div id="scanProg" style="display:none" class="ibox">
      <div style="font-weight:700;margin-bottom:5px">ğŸ¤– AI à¤¸à¥à¤•à¥ˆà¤¨à¤¿à¤‚à¤—â€¦</div>
      <div class="prog-w"><div class="prog-b" id="scanBar" style="width:0%"></div></div>
      <div id="scanTxt" style="font-size:10px;margin-top:3px;color:var(--muted)"></div>
    </div>
    <div id="scanOut"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT â€” CLEAN BUILD V3
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
'use strict';

/* â”€â”€â”€ DATA â”€â”€â”€ */
var DB = {
  clients:   JSON.parse(localStorage.getItem('ca3_clients')   || '[]'),
  invoices:  JSON.parse(localStorage.getItem('ca3_invoices')  || '[]'),
  invest:    JSON.parse(localStorage.getItem('ca3_invest')     || '[]')
};
var cPhoto = null;

function save(key){ localStorage.setItem('ca3_'+key, JSON.stringify(DB[key])); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TABS â€” instant, no lag
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
var TABS = ['dash','smartbot','clients','taxcalc','gst','invoice','invest','taxplan','calendar','reports'];

(function initTabs(){
  document.getElementById('tabBar').addEventListener('click', function(e){
    var btn = e.target.closest('[data-tab]');
    if(!btn) return;
    goTab(btn.dataset.tab);
  });
})();

function goTab(name){
  // hide all
  TABS.forEach(function(t){
    document.getElementById('p-'+t).classList.remove('on');
    var b = document.querySelector('[data-tab="'+t+'"]');
    if(b) b.classList.remove('on');
  });
  // show target
  var panel = document.getElementById('p-'+name);
  if(panel) panel.classList.add('on');
  var btn = document.querySelector('[data-tab="'+name+'"]');
  if(btn) btn.classList.add('on');
  // side effects
  if(name==='clients') renderClients();
  if(name==='invest') renderInvest();
  if(name==='calendar') renderCal();
  refreshDash();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SPEECH SYNTHESIS (VOICE OUT)
   Fixed: voices loaded properly, no delay
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
var VOX = {
  sy: window.speechSynthesis || null,
  on: true,
  v: null
};

function initVox(){
  if(!VOX.sy) return;
  function pick(){
    var all = VOX.sy.getVoices();
    if(!all || !all.length) return;
    // Priority order
    var found = null;
    // 1. Google Hindi
    for(var i=0;i<all.length;i++){ if(all[i].lang==='hi-IN' && all[i].name.indexOf('Google')>-1){found=all[i];break;} }
    // 2. Any Hindi
    if(!found) for(var i=0;i<all.length;i++){ if(all[i].lang==='hi-IN'){found=all[i];break;} }
    // 3. Hindi-ish
    if(!found) for(var i=0;i<all.length;i++){ if(all[i].lang.indexOf('hi')===0){found=all[i];break;} }
    // 4. Indian English
    if(!found) for(var i=0;i<all.length;i++){ if(all[i].lang==='en-IN'){found=all[i];break;} }
    // 5. First available
    if(!found && all.length) found = all[0];
    VOX.v = found;
  }
  pick();
  if(VOX.sy.onvoiceschanged !== undefined){
    VOX.sy.onvoiceschanged = pick;
  }
  // Retry picks for browsers that load voices async
  setTimeout(pick, 300);
  setTimeout(pick, 1000);
  setTimeout(pick, 2500);
}

function speak(txt){
  if(!VOX.on || !VOX.sy) return;
  try{ VOX.sy.cancel(); } catch(e){}
  // Use requestAnimationFrame so cancel flushes first
  requestAnimationFrame(function(){
    requestAnimationFrame(function(){
      try{
        var u = new SpeechSynthesisUtterance(txt);
        u.lang   = 'hi-IN';
        u.rate   = 0.85;
        u.pitch  = 1.0;
        u.volume = 1.0;
        if(VOX.v) u.voice = VOX.v;
        VOX.sy.speak(u);
      }catch(e){ console.warn('speak err',e); }
    });
  });
}

function testSpeak(){
  var all = VOX.sy ? VOX.sy.getVoices() : [];
  var nm = VOX.v ? VOX.v.name+'  ('+VOX.v.lang+')' : 'à¤•à¥‹à¤ˆ Hindi à¤†à¤µà¤¾à¤œà¤¼ à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¥€';
  banner('ğŸ—£ï¸ à¤†à¤µà¤¾à¤œà¤¼: '+nm);
  speak('à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ CA à¤¸à¥Œà¤°à¤­ à¤¬à¤‚à¤¦à¥€ à¤¹à¥‚à¤‚à¥¤ à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆà¥¤ à¤Ÿà¥ˆà¤•à¥à¤¸ à¤”à¤° GST à¤•à¥‡ à¤¸à¤µà¤¾à¤² à¤ªà¥‚à¤›à¥‡à¤‚à¥¤');
}

function toggleVOut(){
  VOX.on = !VOX.on;
  var b = document.getElementById('voutBtn');
  if(VOX.on){
    b.textContent='ğŸ”Š ON'; b.className='tbtn t-blue';
    speak('à¤†à¤µà¤¾à¤œà¤¼ à¤šà¤¾à¤²à¥‚à¥¤'); banner('ğŸ”Š à¤†à¤µà¤¾à¤œà¤¼ ON!');
  } else {
    b.textContent='ğŸ”‡ OFF'; b.className='tbtn t-red';
    try{VOX.sy && VOX.sy.cancel();}catch(e){}
    banner('ğŸ”‡ à¤†à¤µà¤¾à¤œà¤¼ OFFà¥¤');
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SPEECH RECOGNITION (VOICE IN)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
var REC = null;
var recActive = false;

function initRec(){
  var SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(!SR) return;
  REC = new SR();
  REC.lang = 'hi-IN';
  REC.continuous = false;
  REC.interimResults = false;
  REC.onresult = function(e){ handleVoice(e.results[0][0].transcript); };
  REC.onerror  = stopRec;
  REC.onend    = stopRec;
}

function startVoice(){
  if(!REC){ banner('âŒ Chrome / Edge browser à¤®à¥‡à¤‚ Voice à¤•à¤¾à¤® à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤'); return; }
  if(recActive) return;
  recActive = true;
  document.getElementById('vbar').style.display = 'block';
  var b = document.getElementById('voiceBtn');
  b.textContent = 'ğŸ”´ à¤¸à¥à¤¨ à¤°à¤¹à¤¾â€¦';
  b.classList.add('t-pulse');
  speak('à¤¬à¥‹à¤²à¤¿à¤à¥¤');
  setTimeout(function(){ try{ REC.start(); }catch(e){ stopRec(); } }, 400);
}

function stopRec(){
  recActive = false;
  document.getElementById('vbar').style.display = 'none';
  var b = document.getElementById('voiceBtn');
  b.textContent = 'ğŸ¤ à¤†à¤µà¤¾à¤œà¤¼';
  b.classList.remove('t-pulse');
}

function handleVoice(txt){
  stopRec();
  banner('ğŸ¤ "'+txt+'"');
  var t = txt.toLowerCase();
  var map = [
    [['à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ','client'],     'clients',  'à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['à¤‡à¤¨à¤µà¥‰à¤‡à¤¸','invoice','à¤¬à¤¿à¤²'],'invoice',  'à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['à¤Ÿà¥ˆà¤•à¥à¤¸ à¤•à¥ˆà¤²à¤•','tax calc'], 'taxcalc',  'à¤Ÿà¥ˆà¤•à¥à¤¸ à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿà¤° à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['gst','à¤œà¥€à¤à¤¸à¤Ÿà¥€'],          'gst',      'à¤œà¥€à¤à¤¸à¤Ÿà¥€ à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['à¤¨à¤¿à¤µà¥‡à¤¶','invest'],        'invest',   'à¤¨à¤¿à¤µà¥‡à¤¶ à¤Ÿà¥à¤°à¥ˆà¤•à¤° à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ','report'],      'reports',  'à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ à¤–à¥à¤² à¤—à¤ˆà¥¤'],
    [['à¤•à¥ˆà¤²à¥‡à¤‚à¤¡à¤°','calendar'],    'calendar', 'à¤•à¥ˆà¤²à¥‡à¤‚à¤¡à¤° à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['smartbot','à¤¬à¥‰à¤Ÿ','bot'],  'smartbot', 'CA SmartBot à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['à¤ªà¥à¤²à¤¾à¤¨','plan','à¤¬à¤šà¤¤'],    'taxplan',  'à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨ à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡','à¤¹à¥‹à¤®','home'], 'dash',     'à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡ à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤'],
    [['à¤Ÿà¥ˆà¤•à¥à¤¸'],                 'taxcalc',  'à¤Ÿà¥ˆà¤•à¥à¤¸ à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿà¤° à¤–à¥à¤² à¤—à¤¯à¤¾à¥¤']
  ];
  for(var i=0;i<map.length;i++){
    var kws = map[i][0];
    for(var j=0;j<kws.length;j++){
      if(t.indexOf(kws[j])>-1){ goTab(map[i][1]); speak(map[i][2]); return; }
    }
  }
  speak('à¤¸à¤®à¤ à¤¨à¤¹à¥€à¤‚ à¤†à¤¯à¤¾à¥¤ à¤«à¤¿à¤° à¤¬à¥‹à¤²à¥‡à¤‚à¥¤');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   BANNER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
var _bt = null;
function banner(txt){
  document.getElementById('bnrTxt').textContent = txt;
  document.getElementById('banner').style.display = 'block';
  clearTimeout(_bt);
  _bt = setTimeout(hideBanner, 6000);
}
function hideBanner(){ document.getElementById('banner').style.display='none'; }
function aiTip(){
  var tips=['GST-3B à¤•à¥€ à¤¸à¤®à¤¯à¤¸à¥€à¤®à¤¾ 20 à¤¤à¤¾à¤°à¥€à¤–!','80C à¤®à¥‡à¤‚ â‚¹1.5L invest = â‚¹46,800 à¤¬à¤šà¤¤!','NPS: à¤…à¤¤à¤¿à¤°à¤¿à¤•à¥à¤¤ â‚¹50,000 à¤›à¥‚à¤Ÿà¥¤','ITR deadline 31 July â€” à¤…à¤­à¥€ à¤¤à¥ˆà¤¯à¤¾à¤° à¤•à¤°à¥‡à¤‚!','New Regime: â‚¹7L à¤¤à¤• zero tax!'];
  banner(tips[Math.floor(Math.random()*tips.length)]);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   DASHBOARD
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function refreshDash(){
  var el;
  el = document.getElementById('dClients');   if(el) el.textContent = DB.clients.length;
  el = document.getElementById('dInvoices');  if(el) el.textContent = DB.invoices.length;
  var rev = DB.invoices.reduce(function(s,i){return s+(i.total||0);},0);
  el = document.getElementById('dRevenue');   if(el) el.textContent = 'â‚¹'+fmt(rev);
  var sv = DB.invest.reduce(function(s,i){
    if(i.type.indexOf('80c')>-1)   return s+Math.min(i.amt,150000)*0.3;
    if(i.type.indexOf('80d')>-1)   return s+Math.min(i.amt,75000)*0.3;
    if(i.type.indexOf('80ccd')>-1) return s+Math.min(i.amt,50000)*0.3;
    return s;
  },0);
  el = document.getElementById('dSaved');     if(el) el.textContent = 'â‚¹'+fmt(Math.round(sv));
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   CA SMARTBOT (offline KB)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
var KB = {
  'income tax slabs':   'ğŸ“Š <b>Income Tax Slabs 2024-25</b><br><br><b>New Regime (Default):</b><br>â‚¹0â€“3L: 0% | â‚¹3â€“7L: 5% | â‚¹7â€“10L: 10%<br>â‚¹10â€“12L: 15% | â‚¹12â€“15L: 20% | â‚¹15L+: 30%<br><br><b>Old Regime:</b><br>â‚¹0â€“2.5L: 0% | â‚¹2.5â€“5L: 5% | â‚¹5â€“10L: 20% | â‚¹10L+: 30%<br><br>ğŸ’¡ New Regime à¤®à¥‡à¤‚ â‚¹7L à¤¤à¤• à¤¶à¥‚à¤¨à¥à¤¯ à¤Ÿà¥ˆà¤•à¥à¤¸!',
  'gst':                'ğŸ§¾ <b>GST Rates:</b><br>0% â†’ à¤…à¤¨à¤¾à¤œ, à¤¦à¥‚à¤§, à¤¸à¤¬à¥à¤œà¤¿à¤¯à¤¾à¤<br>5% â†’ à¤†à¤µà¤¶à¥à¤¯à¤• à¤µà¤¸à¥à¤¤à¥à¤à¤‚<br>12% â†’ à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤µà¤¸à¥à¤¤à¥à¤à¤‚<br>18% â†’ à¤…à¤§à¤¿à¤•à¤¾à¤‚à¤¶ à¤¸à¥‡à¤µà¤¾à¤à¤‚, FMCG<br>28% â†’ Luxury, à¤•à¤¾à¤°, à¤¤à¤‚à¤¬à¤¾à¤•à¥‚<br><br>Registration: â‚¹40L+ turnover à¤ªà¤° à¤…à¤¨à¤¿à¤µà¤¾à¤°à¥à¤¯à¥¤',
  'itr':                'ğŸ“ <b>ITR Filing Steps:</b><br>1. incometax.gov.in login<br>2. Form à¤šà¥à¤¨à¥‡à¤‚ (ITR-1: salary, ITR-3: business)<br>3. Form 16 à¤¸à¥‡ data fill à¤•à¤°à¥‡à¤‚<br>4. Aadhaar OTP à¤¸à¥‡ e-verify<br><br>â° Deadline: 31 July | Late fee: â‚¹5,000',
  '80c':                'ğŸ’° <b>Section 80C (Max â‚¹1.5L)</b><br><br>â€¢ ELSS â€” 3yr lock, 12-15% return ğŸ”¥<br>â€¢ PPF â€” 7.1%, à¤¸à¤°à¤•à¤¾à¤°à¥€ à¤—à¤¾à¤°à¤‚à¤Ÿà¥€<br>â€¢ LIC Premium, Home Loan Principal<br>â€¢ NSC, Tax Saver FD<br><br>30% bracket â†’ â‚¹46,800 à¤Ÿà¥ˆà¤•à¥à¤¸ à¤¬à¤šà¤¤!',
  'tds':                'ğŸ¦ <b>TDS Rates 2024:</b><br>194C (contractor): 1%/2%<br>194J (professional): 10%<br>194H (commission): 5%<br>194I (rent): 2% / 10%<br>194A (interest): 10%<br><br>Form 26AS à¤ªà¤° track à¤•à¤°à¥‡à¤‚à¥¤',
  'audit':              'ğŸ” <b>Audit Requirements:</b><br>Business turnover > â‚¹1 à¤•à¤°à¥‹à¤¡à¤¼ â†’ Tax Audit 44AB<br>Professional receipts > â‚¹50L<br>All Companies â†’ Statutory Audit<br><br>Deadline: 30 September',
  'capital gains':      'ğŸ“ˆ <b>Capital Gains Tax:</b><br>STCG (Equity < 1yr): 20%<br>LTCG (Equity > 1yr): 12.5%<br>Property LTCG: 12.5% (2yr+)<br><br>Sec 54: à¤¨à¤¯à¤¾ à¤˜à¤° à¤–à¤°à¥€à¤¦à¥‡à¤‚ â†’ à¤Ÿà¥ˆà¤•à¥à¤¸ à¤¬à¤šà¤¾à¤à¤‚!',
  'new vs old':         'âš–ï¸ <b>New vs Old Regime:</b><br><b>New à¤šà¥à¤¨à¥‡à¤‚</b> â€” Income â‰¤ â‚¹7L, à¤•à¤® investments<br><b>Old à¤šà¥à¤¨à¥‡à¤‚</b> â€” HRA + 80C full + Home Loan + Income â‚¹10L+<br><br>CA à¤¸à¥‡ calculate à¤•à¤°à¤µà¤¾à¤à¤‚à¥¤',
  'home loan':          'ğŸ  <b>Home Loan Tax Benefits:</b><br>Sec 24(b): Interest â‚¹2L deduction<br>Sec 80C: Principal â‚¹1.5L<br>Sec 80EEA: Extra â‚¹1.5L (first buyer)<br><br>Total â‚¹5L+ à¤¬à¤šà¤¤ à¤¸à¤‚à¤­à¤µ!',
  'pan':                'ğŸªª <b>PAN Card:</b><br>Format: ABCDE1234F<br>à¤œà¤°à¥‚à¤°à¥€: ITR, Bank account, â‚¹50K+ transactions<br>Apply: onlineservices.nsdl.com',
  'à¤¨à¤®à¤¸à¥à¤¤à¥‡':            'à¤¨à¤®à¤¸à¥à¤¤à¥‡! ğŸ™ à¤®à¥ˆà¤‚ CA SmartBot à¤¹à¥‚à¤‚à¥¤ Tax, GST, ITR à¤ªà¥‚à¤›à¥‡à¤‚!',
  'hello':              'Hello! I am CA SmartBot. Ask Tax, GST or Finance questions!'
};
var DEFS = ['à¤‡à¤¸ topic à¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤…à¤­à¥€ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆà¥¤ Income Tax, GST, TDS, 80C try à¤•à¤°à¥‡à¤‚à¥¤','à¤¯à¤¹ specific à¤¸à¤µà¤¾à¤² à¤¨à¤¹à¥€à¤‚ à¤œà¤¾à¤¨à¤¤à¤¾à¥¤ Tax, GST, Audit topics à¤ªà¥‚à¤›à¥‡à¤‚à¥¤'];
var DISC = '<div class="dis">âš ï¸ Educational only â€” Official advice à¤•à¥‡ à¤²à¤¿à¤ CA à¤¸à¥‡ à¤®à¤¿à¤²à¥‡à¤‚à¥¤</div>';

function kbGet(msg){
  var l = msg.toLowerCase();
  for(var k in KB){ if(l===k || l.indexOf(k)>-1) return KB[k]; }
  var words = l.split(/\s+/);
  for(var w=0;w<words.length;w++){
    if(words[w].length>3){
      for(var k in KB){ if(k.indexOf(words[w])>-1) return KB[k]; }
    }
  }
  return DEFS[Math.floor(Math.random()*DEFS.length)];
}

function sbQ(q){ document.getElementById('sbIn').value=q; sbSend(); }
function sbSend(){
  var el = document.getElementById('sbIn');
  var msg = el.value.trim(); if(!msg) return; el.value='';
  var box = document.getElementById('sbMsgs');
  box.innerHTML += '<div class="msg-user">'+esc(msg)+'</div>';
  var t = document.createElement('div'); t.className='typing'; t.innerHTML='<span></span><span></span><span></span>';
  box.appendChild(t); box.scrollTop=box.scrollHeight;
  setTimeout(function(){
    t.remove();
    var r = kbGet(msg);
    var noDisc = (msg==='à¤¨à¤®à¤¸à¥à¤¤à¥‡'||msg.toLowerCase()==='hello');
    box.innerHTML += '<div class="msg-bot"><div class="msg-lbl">ğŸ“ CA SmartBot</div>'+r+(noDisc?'':DISC)+'</div>';
    box.scrollTop = box.scrollHeight;
  }, 600);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   GEMINI CHATBOT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
var SYS = 'à¤¤à¥à¤® SourabhBandi CA à¤¹à¥‹ â€” à¤µà¤°à¤¿à¤·à¥à¤  Chartered Accountantà¥¤ à¤­à¤¾à¤°à¤¤à¥€à¤¯ Income Tax, GST, TDS, Audit à¤¸à¤µà¤¾à¤²à¥‹à¤‚ à¤•à¤¾ à¤œà¤µà¤¾à¤¬ Hindi/English mix à¤®à¥‡à¤‚ à¤¦à¥‹à¥¤ à¤¹à¤° à¤œà¤µà¤¾à¤¬ à¤•à¥‡ à¤…à¤‚à¤¤ à¤®à¥‡à¤‚ à¤²à¤¿à¤–à¥‹: âš ï¸ Official advice à¤•à¥‡ à¤²à¤¿à¤ CA à¤¸à¥‡ à¤®à¤¿à¤²à¥‡à¤‚à¥¤';

function saveKey(){
  var k = document.getElementById('gKey').value.trim();
  if(!k.startsWith('AIza')){ alert('âŒ à¤¸à¤¹à¥€ Gemini Key à¤¡à¤¾à¤²à¥‡à¤‚ (AIza à¤¸à¥‡ à¤¶à¥à¤°à¥‚)'); return; }
  localStorage.setItem('ca3_gk', k);
  document.getElementById('keyBox').style.display='none';
  cbAdd('bot','âœ… API Key save à¤¹à¥‹ à¤—à¤ˆ! à¤…à¤¬ Real Gemini AI à¤¸à¥‡ à¤ªà¥‚à¤›à¥‡à¤‚ ğŸ‰');
}

function getKey(){
  var k = localStorage.getItem('ca3_gk')||'';
  if(k) document.getElementById('keyBox').style.display='none';
  return k;
}

function toggleChat(){
  var c = document.getElementById('chatbot');
  var f = document.getElementById('fab');
  if(c.style.display==='flex'){
    c.style.display='none'; f.style.display='flex';
  } else {
    c.style.display='flex'; c.style.flexDirection='column'; f.style.display='none';
    getKey();
  }
}

function cbAdd(type, html){
  var box = document.getElementById('cbMsgs');
  if(type==='user'){
    box.innerHTML += '<div class="msg-user">'+html+'</div>';
  } else {
    box.innerHTML += '<div class="msg-bot"><div class="msg-lbl">ğŸ¤– SourabhBandi CA</div>'+html+'</div>';
  }
  box.scrollTop = box.scrollHeight;
}

function qAsk(q){ document.getElementById('cbIn').value=q; sendMsg(); }

function sendMsg(){
  var el = document.getElementById('cbIn');
  var msg = el.value.trim(); if(!msg) return; el.value='';
  var KEY = getKey();
  cbAdd('user', esc(msg));
  var box = document.getElementById('cbMsgs');
  var t = document.createElement('div'); t.className='typing'; t.id='cbt';
  t.innerHTML='<span></span><span></span><span></span>';
  box.appendChild(t); box.scrollTop=box.scrollHeight;
  var btn = document.getElementById('cbSend'); btn.disabled=true;

  // No key â†’ offline KB
  if(!KEY){
    setTimeout(function(){
      var e=document.getElementById('cbt'); if(e)e.remove(); btn.disabled=false;
      var r=kbGet(msg); var nd=(msg==='à¤¨à¤®à¤¸à¥à¤¤à¥‡'||msg.toLowerCase()==='hello');
      cbAdd('bot', r+(nd?'':DISC));
    }, 600);
    return;
  }

  // Gemini API
  fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key='+KEY,{
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({
      contents:[{parts:[{text:SYS+'\n\nà¤¸à¤µà¤¾à¤²: '+msg}]}],
      generationConfig:{maxOutputTokens:500,temperature:0.75}
    })
  })
  .then(function(r){ return r.json(); })
  .then(function(d){
    var e=document.getElementById('cbt'); if(e)e.remove(); btn.disabled=false;
    if(d.error){ cbAdd('bot','âŒ '+d.error.message+'<br><small style="color:var(--muted)">Key à¤—à¤²à¤¤ à¤¯à¤¾ quota à¤–à¤¤à¥à¤®à¥¤</small>'); document.getElementById('keyBox').style.display='block'; return; }
    var reply = d.candidates&&d.candidates[0] ? d.candidates[0].content.parts[0].text : 'à¤œà¤µà¤¾à¤¬ à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¤¾à¥¤';
    var fmt = reply.replace(/\*\*(.*?)\*\*/g,'<b>$1</b>').replace(/\n/g,'<br>');
    cbAdd('bot', fmt);
    if(VOX.on) speak(reply.replace(/[*_#\[\]]/g,'').substring(0,260));
  })
  .catch(function(){
    var e=document.getElementById('cbt'); if(e)e.remove(); btn.disabled=false;
    cbAdd('bot','âŒ Network errorà¥¤ Internet check à¤•à¤°à¥‡à¤‚à¥¤');
  });
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   CLIENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showCF(){ document.getElementById('cForm').style.display='block'; }
function hideCF(){
  document.getElementById('cForm').style.display='none';
  ['cName','cPAN','cGST','cEmail','cPhone','cAddr'].forEach(function(id){document.getElementById(id).value='';});
  cPhoto=null; document.getElementById('photoBox').innerHTML='ğŸ‘¤'; document.getElementById('photoIn').value='';
}
function prevPhoto(e){
  var f=e.target.files[0]; if(!f) return;
  var r=new FileReader();
  r.onload=function(ev){ cPhoto=ev.target.result; document.getElementById('photoBox').innerHTML='<img src="'+ev.target.result+'"/>'; };
  r.readAsDataURL(f);
}
function chkPAN(el){
  var v=el.value,s=document.getElementById('panMsg');
  if(v.length===10){ var ok=/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(v); s.textContent=ok?'âœ… à¤µà¥ˆà¤§':'âŒ à¤…à¤®à¤¾à¤¨à¥à¤¯'; s.style.color=ok?'var(--green)':'var(--red)'; }
  else s.textContent='';
}
function chkGST(el){
  var v=el.value,s=document.getElementById('gstMsg');
  if(v.length===15){ var ok=/^\d{2}[A-Z]{5}\d{4}[A-Z][1-9A-Z]Z[0-9A-Z]$/.test(v); s.textContent=ok?'âœ… à¤µà¥ˆà¤§':'âŒ à¤…à¤®à¤¾à¤¨à¥à¤¯'; s.style.color=ok?'var(--green)':'var(--red)'; }
  else if(v.length) s.textContent=(15-v.length)+' à¤¶à¥‡à¤·';
  else s.textContent='';
}
function saveC(){
  var nm=document.getElementById('cName').value.trim();
  var pan=document.getElementById('cPAN').value.trim();
  if(!nm||!pan){ speak('à¤¨à¤¾à¤® à¤”à¤° PAN à¤­à¤°à¥‡à¤‚à¥¤'); return; }
  DB.clients.push({id:Date.now(),name:nm,pan:pan,gst:document.getElementById('cGST').value,email:document.getElementById('cEmail').value,phone:document.getElementById('cPhone').value,biz:document.getElementById('cBiz').value,addr:document.getElementById('cAddr').value,photo:cPhoto});
  save('clients'); hideCF(); renderClients(); loadInvC(); refreshDash();
  banner('âœ… '+nm+' à¤œà¥‹à¤¡à¤¼à¤¾ à¤—à¤¯à¤¾!'); speak(nm+' à¤œà¥‹à¤¡à¤¼à¤¾ à¤—à¤¯à¤¾à¥¤');
}
function renderClients(){
  var el=document.getElementById('cList');
  var q=document.getElementById('csrch').value.toLowerCase();
  var list=DB.clients.filter(function(c){ return !q||(c.name.toLowerCase().indexOf(q)>-1||c.pan.toLowerCase().indexOf(q)>-1); });
  if(!list.length){ el.innerHTML='<div style="text-align:center;padding:26px;color:var(--muted)">'+(DB.clients.length?'à¤•à¥‹à¤ˆ à¤ªà¤°à¤¿à¤£à¤¾à¤® à¤¨à¤¹à¥€à¤‚à¥¤':'à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤¨à¤¹à¥€à¤‚à¥¤ "à¤¨à¤¯à¤¾ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ" à¤¸à¥‡ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚à¥¤')+'</div>'; return; }
  el.innerHTML=list.map(function(c){
    return '<div class="ccrd"><div class="av">'+(c.photo?'<img src="'+c.photo+'"/>':'ğŸ‘¤')+'</div><div style="flex:1"><div style="font-weight:800">'+esc(c.name)+'</div><div style="font-size:11px;color:var(--muted);margin-top:2px">PAN: '+c.pan+' Â· '+c.biz+(c.gst?' Â· GST: '+c.gst:'')+'</div>'+(c.phone?'<div style="font-size:10px;color:var(--muted)">ğŸ“ '+c.phone+'</div>':'')+'</div><button onclick="delC('+c.id+')" style="background:none;border:1px solid var(--red);color:var(--red);padding:4px 9px;border-radius:5px;cursor:pointer;font-size:11px">ğŸ—‘ï¸</button></div>';
  }).join('');
}
function delC(id){
  if(!confirm('à¤‡à¤¸ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤•à¥‹ à¤¹à¤Ÿà¤¾à¤à¤‚?')) return;
  DB.clients=DB.clients.filter(function(c){return c.id!==id;});
  save('clients'); renderClients(); loadInvC(); refreshDash();
}
function srchC(){ renderClients(); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TAX CALCULATOR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function regTip(){
  var inc=parseFloat(document.getElementById('tcInc').value)||0;
  var el=document.getElementById('regTipBox');
  if(!inc){el.style.display='none';return;}
  el.style.display='block';
  el.textContent=inc<=700000?'ğŸ¤– New Regime à¤¬à¥‡à¤¹à¤¤à¤° â€” â‚¹7L à¤¤à¤• zero tax!':inc<=1000000?'ğŸ¤– à¤¦à¥‹à¤¨à¥‹à¤‚ try à¤•à¤°à¥‡à¤‚, CA à¤¸à¥‡ verify à¤•à¤°à¥‡à¤‚à¥¤':'ğŸ¤– Old Regime usually à¤¬à¥‡à¤¹à¤¤à¤° â€” HRA+80C+Home Loan à¤¹à¥ˆ à¤¤à¥‹à¥¤';
}
function calcTax(){
  var g=parseFloat(document.getElementById('tcInc').value)||0;
  if(!g){speak('à¤†à¤¯ à¤¡à¤¾à¤²à¥‡à¤‚à¥¤');return;}
  var reg=document.getElementById('tcReg').value;
  var ded=reg==='old'?(parseFloat(document.getElementById('tcDed').value)||0):0;
  var tx=Math.max(0,g-ded),t=0;
  if(reg==='new'){
    if(tx>1500000) t=140000+(tx-1500000)*0.3;
    else if(tx>1200000) t=80000+(tx-1200000)*0.2;
    else if(tx>1000000) t=50000+(tx-1000000)*0.15;
    else if(tx>700000)  t=20000+(tx-700000)*0.1;
    else if(tx>300000)  t=(tx-300000)*0.05;
  } else {
    if(tx>1000000) t=112500+(tx-1000000)*0.3;
    else if(tx>500000) t=12500+(tx-500000)*0.2;
    else if(tx>250000) t=(tx-250000)*0.05;
  }
  var cs=t*0.04,tot=t+cs;
  set('rGross','â‚¹'+fmt(g)); set('rTaxable','â‚¹'+fmt(tx));
  set('rTax','â‚¹'+fmt(Math.round(t))); set('rCess','â‚¹'+fmt(Math.round(cs)));
  set('rTotal','â‚¹'+fmt(Math.round(tot)));
  set('taxTip',tot>0?'ğŸ’¡ 80C à¤®à¥‡à¤‚ invest à¤•à¤°à¥‡à¤‚ â€” à¤”à¤° à¤Ÿà¥ˆà¤•à¥à¤¸ à¤¬à¤šà¤¾à¤à¤‚!':'âœ… à¤•à¥‹à¤ˆ à¤Ÿà¥ˆà¤•à¥à¤¸ à¤¨à¤¹à¥€à¤‚!');
  document.getElementById('taxRes').style.display='block';
  speak('à¤•à¥à¤² à¤¦à¥‡à¤¯ à¤Ÿà¥ˆà¤•à¥à¤¸ '+fmt(Math.round(tot))+' à¤°à¥à¤ªà¤¯à¥‡à¥¤');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TDS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function calcTDS(){
  var amt=parseFloat(document.getElementById('tdsAmt').value)||0;
  if(!amt){speak('à¤°à¤¾à¤¶à¤¿ à¤¡à¤¾à¤²à¥‡à¤‚à¥¤');return;}
  var rate=parseFloat(document.getElementById('tdsSec').value)||1;
  var tds=amt*rate/100,net=amt-tds;
  set('tAmt','â‚¹'+fmt(amt)); set('tRate',rate+'%');
  set('tTDS','â‚¹'+tds.toFixed(2)); set('tNet','â‚¹'+net.toFixed(2));
  document.getElementById('tdsRes').style.display='block';
  speak('TDS '+tds.toFixed(0)+' à¤°à¥à¤ªà¤¯à¥‡ à¤•à¤¾à¤Ÿà¥€à¥¤ à¤¶à¥à¤¦à¥à¤§ '+net.toFixed(0)+' à¤°à¥à¤ªà¤¯à¥‡à¥¤');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   GST
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function calcGST(){
  var type=document.getElementById('gType').value;
  var amt=parseFloat(document.getElementById('gAmt').value)||0;
  if(!amt){speak('à¤°à¤¾à¤¶à¤¿ à¤¡à¤¾à¤²à¥‡à¤‚à¥¤');return;}
  var rate=parseFloat(document.getElementById('gRate').value)||0;
  var base,total,gstA;
  if(type==='ex'){ base=amt; gstA=amt*rate/100; total=amt+gstA; }
  else { total=amt; base=amt/(1+rate/100); gstA=total-base; }
  var half=rate/2;
  set('gBase','â‚¹'+base.toFixed(2));
  set('gCR',half); set('gCGST','â‚¹'+(gstA/2).toFixed(2));
  set('gSR',half); set('gSGST','â‚¹'+(gstA/2).toFixed(2));
  set('gTotal','â‚¹'+total.toFixed(2));
  document.getElementById('gstRes').style.display='block';
  speak('à¤•à¥à¤² à¤°à¤¾à¤¶à¤¿ '+total.toFixed(0)+' à¤°à¥à¤ªà¤¯à¥‡à¥¤');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   INVOICE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function loadInvC(){
  var s=document.getElementById('iClient');
  s.innerHTML='<option value="">â€” à¤šà¥à¤¨à¥‡à¤‚ â€”</option>'+DB.clients.map(function(c){return '<option value="'+c.id+'">'+esc(c.name)+'</option>';}).join('');
}
function quickInv(){
  if(!DB.clients.length){speak('à¤ªà¤¹à¤²à¥‡ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚à¥¤');return;}
  document.getElementById('iClient').value=DB.clients[0].id;
  if(!document.getElementById('iItems').children.length) addItem();
}
function addItem(){
  var id='it'+Date.now();
  document.getElementById('iItems').insertAdjacentHTML('beforeend',
    '<div id="'+id+'" style="display:grid;grid-template-columns:3fr 1fr 1fr 1fr auto;gap:5px;margin-bottom:5px;align-items:center">'+
    '<input class="inp" placeholder="à¤µà¤¿à¤µà¤°à¤£" style="padding:7px" oninput="calcInvTot()"/>'+
    '<input class="inp" type="number" value="1" style="padding:7px" oninput="calcInvTot()"/>'+
    '<input class="inp" type="number" placeholder="à¤¦à¤°" style="padding:7px" oninput="calcInvTot()"/>'+
    '<input class="inp" readonly style="padding:7px;background:var(--bg)" value="â‚¹0"/>'+
    '<button onclick="this.parentNode.remove();calcInvTot()" style="background:none;border:1px solid var(--red);color:var(--red);padding:7px 9px;border-radius:6px;cursor:pointer">ğŸ—‘ï¸</button>'+
    '</div>'
  );
}
function calcInvTot(){
  var sub=0;
  document.querySelectorAll('#iItems>div').forEach(function(d){
    var ins=d.querySelectorAll('input');
    var t=(parseFloat(ins[1].value)||0)*(parseFloat(ins[2].value)||0);
    ins[3].value='â‚¹'+t.toFixed(2); sub+=t;
  });
  var gst=sub*0.18,tot=sub+gst;
  set('iSub','â‚¹'+sub.toFixed(2)); set('iGST','â‚¹'+gst.toFixed(2)); set('iTotal','â‚¹'+tot.toFixed(2));
}
function genInv(){
  var cId=document.getElementById('iClient').value;
  var dt=document.getElementById('iDate').value;
  var num=document.getElementById('iNum').value;
  if(!cId||!dt||!num){speak('à¤¸à¤­à¥€ à¤«à¥€à¤²à¥à¤¡ à¤­à¤°à¥‡à¤‚à¥¤');return;}
  var cl=DB.clients.find(function(c){return c.id==cId;});
  var items=[];
  document.querySelectorAll('#iItems>div').forEach(function(d){
    var ins=d.querySelectorAll('input');
    var q=parseFloat(ins[1].value)||0,r=parseFloat(ins[2].value)||0;
    items.push({desc:ins[0].value,qty:q,rate:r,total:q*r});
  });
  var sub=items.reduce(function(s,i){return s+i.total;},0),gst=sub*0.18,tot=sub+gst;
  DB.invoices.push({id:Date.now(),number:num,date:dt,client:cl,items:items,sub:sub,gst:gst,total:tot});
  save('invoices'); refreshDash();
  var prev=document.getElementById('invPrev');
  prev.innerHTML='<h2 style="color:#1d4ed8;margin-bottom:8px">à¤•à¤° à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ #'+num+'</h2>'+
    '<div style="display:flex;justify-content:space-between;margin-bottom:14px">'+
    '<div><strong>'+esc(cl.name)+'</strong><br><span style="font-size:12px;color:#555">PAN: '+cl.pan+'</span></div>'+
    '<div style="text-align:right;font-size:12px;color:#555">à¤¤à¤¾à¤°à¥€à¤–: '+new Date(dt).toLocaleDateString('hi-IN')+'</div></div>'+
    '<table style="width:100%;border-collapse:collapse;font-size:13px;margin-bottom:14px">'+
    '<thead><tr style="background:#f3f4f6"><th style="padding:8px;border:1px solid #e5e7eb;text-align:left">à¤µà¤¿à¤µà¤°à¤£</th><th style="padding:8px;border:1px solid #e5e7eb">Qty</th><th style="padding:8px;border:1px solid #e5e7eb;text-align:right">à¤¦à¤°</th><th style="padding:8px;border:1px solid #e5e7eb;text-align:right">à¤°à¤¾à¤¶à¤¿</th></tr></thead>'+
    '<tbody>'+items.map(function(i){return '<tr><td style="padding:8px;border:1px solid #e5e7eb">'+esc(i.desc)+'</td><td style="padding:8px;border:1px solid #e5e7eb;text-align:center">'+i.qty+'</td><td style="padding:8px;border:1px solid #e5e7eb;text-align:right">â‚¹'+i.rate.toFixed(2)+'</td><td style="padding:8px;border:1px solid #e5e7eb;text-align:right">â‚¹'+i.total.toFixed(2)+'</td></tr>';}).join('')+'</tbody></table>'+
    '<div style="text-align:right"><div>à¤‰à¤ª-à¤•à¥à¤²: <strong>â‚¹'+sub.toFixed(2)+'</strong></div>'+
    '<div>GST 18%: <strong>â‚¹'+gst.toFixed(2)+'</strong></div>'+
    '<div style="font-size:1.2rem;font-weight:800;color:#059669;margin-top:8px">à¤•à¥à¤²: â‚¹'+tot.toFixed(2)+'</div></div>';
  prev.style.display='block';
  var n=parseInt((num.split('-')[1]||'0'))+1;
  document.getElementById('iNum').value='INV-'+String(n).padStart(4,'0');
  speak('à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ '+num+' à¤¬à¤¨ à¤—à¤¯à¤¾à¥¤ à¤•à¥à¤² '+fmt(Math.round(tot))+' à¤°à¥à¤ªà¤¯à¥‡à¥¤');
}
function printInv(){
  if(document.getElementById('invPrev').style.display==='none'){ speak('à¤ªà¤¹à¤²à¥‡ à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ à¤¬à¤¨à¤¾à¤à¤‚à¥¤'); return; }
  window.print();
}
function resetInv(){
  document.getElementById('iClient').value='';
  document.getElementById('iItems').innerHTML='';
  addItem(); calcInvTot();
  document.getElementById('invPrev').style.display='none';
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   INVESTMENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showInvInfo(){
  var t=document.getElementById('invType').value,el=document.getElementById('invInfoBox');
  var info={'ppf-80c':'PPF: 7.1% à¤¬à¥à¤¯à¤¾à¤œ, 15 à¤¸à¤¾à¤² lock-in â€” à¤¸à¤¬à¤¸à¥‡ à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤à¥¤','elss-80c':'ELSS: 3yr lock, 12-15% return â€” Best for 80C! ğŸ”¥','health-80d':'80D: â‚¹25,000 (Senior parents â‚¹75,000)','nps-80ccd':'NPS: 80C à¤•à¥‡ à¤…à¤²à¤¾à¤µà¤¾ â‚¹50,000 extra à¤›à¥‚à¤Ÿ â€” à¤œà¤°à¥‚à¤° à¤•à¤°à¥‡à¤‚!'};
  if(info[t]){ el.innerHTML='ğŸ’¡ '+info[t]; el.style.display='block'; } else el.style.display='none';
}
function saveInv(){
  var type=document.getElementById('invType').value;
  var amt=parseFloat(document.getElementById('invAmt').value);
  if(!type||!amt){speak('à¤ªà¥à¤°à¤•à¤¾à¤° à¤”à¤° à¤°à¤¾à¤¶à¤¿ à¤­à¤°à¥‡à¤‚à¥¤');return;}
  var txt=document.getElementById('invType').options[document.getElementById('invType').selectedIndex].text;
  DB.invest.push({id:Date.now(),type:type,label:txt,amt:amt,date:document.getElementById('invDt').value,note:document.getElementById('invNote').value});
  save('invest'); document.getElementById('invForm').style.display='none'; renderInvest(); refreshDash();
  speak(txt+' à¤®à¥‡à¤‚ '+fmt(amt)+' à¤°à¥à¤ªà¤¯à¥‡ à¤¸à¥‡à¤µà¥¤');
}
function delInv(id){
  if(!confirm('à¤¹à¤Ÿà¤¾à¤à¤‚?')) return;
  DB.invest=DB.invest.filter(function(i){return i.id!==id;});
  save('invest'); renderInvest(); refreshDash();
}
function renderInvest(){
  var c=0,d=0,n=0;
  DB.invest.forEach(function(i){
    if(i.type.indexOf('80c')>-1)   c+=i.amt;
    if(i.type.indexOf('80d')>-1)   d+=i.amt;
    if(i.type.indexOf('80ccd')>-1) n+=i.amt;
  });
  var pb=document.getElementById('prog80C'); if(pb) pb.style.width=Math.min(100,c/1500)+'%';
  var e=document.getElementById('inv80C'); if(e) e.textContent='â‚¹'+fmt(c);
  var e2=document.getElementById('inv80D'); if(e2) e2.textContent='â‚¹'+fmt(d);
  var e3=document.getElementById('invNPS'); if(e3) e3.textContent='â‚¹'+fmt(n);
  var sv=Math.round((Math.min(c,150000)+Math.min(d,75000)+Math.min(n,50000))*0.3);
  var e4=document.getElementById('taxSaved'); if(e4) e4.textContent='â‚¹'+fmt(sv);
  var el=document.getElementById('invList'); if(!el) return;
  if(!DB.invest.length){ el.innerHTML='<div style="text-align:center;padding:20px;color:var(--muted)">à¤•à¥‹à¤ˆ à¤¨à¤¿à¤µà¥‡à¤¶ à¤¨à¤¹à¥€à¤‚à¥¤</div>'; return; }
  el.innerHTML=DB.invest.map(function(i){
    return '<div class="ccrd"><div style="flex:1"><div style="font-weight:700">'+i.label+'</div><div style="font-size:10px;color:var(--muted)">'+i.date+(i.note?' Â· '+i.note:'')+'</div></div><div style="font-weight:800;color:var(--accent);margin-right:10px">â‚¹'+fmt(i.amt)+'</div><button onclick="delInv('+i.id+')" style="background:none;border:1px solid var(--red);color:var(--red);padding:4px 8px;border-radius:5px;cursor:pointer;font-size:11px">ğŸ—‘ï¸</button></div>';
  }).join('');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TAX PLAN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function genPlan(){
  var inc=parseFloat(document.getElementById('pInc').value)||0;
  var age=parseInt(document.getElementById('pAge').value)||30;
  var parents=document.getElementById('pPar').value==='yes';
  var risk=document.getElementById('pRisk').value;
  if(!inc){speak('à¤†à¤¯ à¤¡à¤¾à¤²à¥‡à¤‚à¥¤');return;}
  speak('AI à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨ à¤¬à¤¨ à¤°à¤¹à¤¾ à¤¹à¥ˆà¥¤');
  var br=inc>1500000?30:inc>1000000?20:inc>700000?10:5;
  var recs=risk==='low'?[{t:'PPF',a:70000,r:'7.1% safe'},{t:'NSC',a:50000,r:'7.7% safe'},{t:'LIC',a:30000,r:'Insurance'}]:
           risk==='mid'?[{t:'ELSS',a:70000,r:'12-15% return'},{t:'PPF',a:50000,r:'7.1%'},{t:'NPS',a:50000,r:'Extra â‚¹50K'}]:
                        [{t:'ELSS',a:100000,r:'12-15% market'},{t:'NPS',a:50000,r:'Extra â‚¹50K'},{t:'SIP (Index)',a:50000,r:'Long term'}];
  var tots=150000+(parents?75000:25000)+50000;
  var sv=Math.round(tots*br/100);
  document.getElementById('planOut').innerHTML=
    '<div class="card" style="border-color:var(--accent)">'+
    '<div class="card-title" style="color:var(--accent)">âœ… à¤†à¤ªà¤•à¤¾ AI à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨</div>'+
    '<div class="g3" style="margin-bottom:12px">'+
    '<div class="stat" style="padding:10px"><div style="font-size:10px;color:var(--muted)">à¤µà¤¾à¤°à¥à¤·à¤¿à¤• à¤†à¤¯</div><div style="font-size:1rem;font-weight:800;color:var(--accent)">â‚¹'+fmt(inc)+'</div></div>'+
    '<div class="stat" style="padding:10px"><div style="font-size:10px;color:var(--muted)">à¤•à¥à¤² à¤¨à¤¿à¤µà¥‡à¤¶</div><div style="font-size:1rem;font-weight:800;color:var(--accent2)">â‚¹'+fmt(tots)+'</div></div>'+
    '<div class="stat" style="padding:10px"><div style="font-size:10px;color:var(--muted)">à¤…à¤¨à¥à¤®à¤¾à¤¨à¤¿à¤¤ à¤¬à¤šà¤¤</div><div style="font-size:1rem;font-weight:800;color:var(--gold)">â‚¹'+fmt(sv)+'</div></div>'+
    '</div>'+
    recs.map(function(r){return '<div class="ccrd" style="margin-bottom:7px"><div style="flex:1"><div style="font-weight:800">'+r.t+'</div><div style="font-size:10px;color:var(--muted)">'+r.r+' | à¤¬à¤šà¤¤: â‚¹'+fmt(Math.round(r.a*br/100))+'</div></div><div style="font-weight:800;color:var(--accent)">â‚¹'+fmt(r.a)+'</div></div>';}).join('')+
    (age<35?'<div class="ibox">ğŸ’¡ à¤¯à¥à¤µà¤¾ à¤¹à¥ˆà¤‚ â€” ELSS à¤®à¥‡à¤‚ à¤…à¤§à¤¿à¤• invest à¤•à¤°à¥‡à¤‚, à¤²à¤‚à¤¬à¥‡ à¤¸à¤®à¤¯ à¤®à¥‡à¤‚ à¤…à¤§à¤¿à¤• à¤«à¤¾à¤¯à¤¦à¤¾!</div>':'')+
    '<div class="ibox" style="margin-top:8px">â° à¤…à¤ªà¥à¤°à¥ˆà¤² à¤¸à¥‡ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚ â€” March à¤¤à¤• wait à¤¨ à¤•à¤°à¥‡à¤‚!</div>'+
    '<button class="btn blue" onclick="window.print()" style="margin-top:10px">ğŸ–¨ï¸ à¤ªà¥à¤°à¤¿à¤‚à¤Ÿ</button>'+
    '</div>';
  speak('à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨ à¤¤à¥ˆà¤¯à¤¾à¤°à¥¤ â‚¹'+fmt(sv)+' à¤¬à¤šà¤¾ à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   CALENDAR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderCal(){
  var d=new Date(),dt=d.getDate(),el=document.getElementById('calDL');
  if(!el) return;
  var arr=[];
  if(dt<=11)  arr.push('ğŸ“‹ GSTR-1 â†’ '+(11-dt)+' à¤¦à¤¿à¤¨ à¤¶à¥‡à¤·');
  if(dt<=20)  arr.push('ğŸ“‹ GSTR-3B â†’ '+(20-dt)+' à¤¦à¤¿à¤¨ à¤¶à¥‡à¤·');
  if(d.getMonth()===6&&dt<=31) arr.push('âš ï¸ ITR â†’ '+(31-dt)+' à¤¦à¤¿à¤¨ à¤¶à¥‡à¤·');
  el.innerHTML = arr.length ? arr.map(function(x){return '<div>â€¢ '+x+'</div>';}).join('') : '<div>âœ… à¤‡à¤¸ à¤®à¤¾à¤¹ à¤•à¥‹à¤ˆ à¤¤à¤¤à¥à¤•à¤¾à¤² à¤¡à¥‡à¤¡à¤²à¤¾à¤‡à¤¨ à¤¨à¤¹à¥€à¤‚à¥¤</div>';
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   REPORTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function rptClient(){
  var el=document.getElementById('rptOut');
  el.innerHTML='<div class="card"><div class="card-title">ğŸ‘¥ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ</div>'+
    '<div class="ibox" style="margin-bottom:12px">ğŸ¤– à¤•à¥à¤²: '+DB.clients.length+' à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ | GST à¤µà¤¾à¤²à¥‡: '+DB.clients.filter(function(c){return c.gst;}).length+'</div>'+
    (DB.clients.length?'<table><thead><tr><th>à¤¨à¤¾à¤®</th><th>PAN</th><th>à¤µà¥à¤¯à¤µà¤¸à¤¾à¤¯</th></tr></thead><tbody>'+
    DB.clients.map(function(c){return '<tr><td>'+esc(c.name)+'</td><td>'+c.pan+'</td><td>'+c.biz+'</td></tr>';}).join('')+'</tbody></table>':
    '<div style="text-align:center;color:var(--muted);padding:18px">à¤•à¥‹à¤ˆ à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ à¤¨à¤¹à¥€à¤‚à¥¤</div>')+'</div>';
}
function rptInvoice(){
  var tot=DB.invoices.reduce(function(s,i){return s+i.total;},0);
  document.getElementById('rptOut').innerHTML=
    '<div class="card"><div class="card-title">ğŸ§¾ à¤‡à¤¨à¤µà¥‰à¤‡à¤¸ à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ</div>'+
    '<div class="g3"><div class="stat" style="padding:10px"><div style="font-size:10px;color:var(--muted)">à¤•à¥à¤² à¤‡à¤¨à¤µà¥‰à¤‡à¤¸</div><div style="font-size:1.5rem;font-weight:800;color:var(--accent)">'+DB.invoices.length+'</div></div>'+
    '<div class="stat" style="padding:10px"><div style="font-size:10px;color:var(--muted)">à¤•à¥à¤² à¤†à¤¯</div><div style="font-size:1.1rem;font-weight:800;color:var(--gold)">â‚¹'+fmt(Math.round(tot))+'</div></div>'+
    '<div class="stat" style="padding:10px"><div style="font-size:10px;color:var(--muted)">à¤”à¤¸à¤¤</div><div style="font-size:1.1rem;font-weight:800;color:var(--accent2)">â‚¹'+fmt(DB.invoices.length?Math.round(tot/DB.invoices.length):0)+'</div></div></div></div>';
}
function rptTax(){
  document.getElementById('rptOut').innerHTML='<div class="card"><div class="card-title">ğŸ’¡ à¤Ÿà¥ˆà¤•à¥à¤¸ à¤‘à¤ªà¥à¤Ÿà¤¿à¤®à¤¾à¤‡à¤œà¤¼</div><div class="ibox">ğŸ¤– "ğŸ’¡ à¤ªà¥à¤²à¤¾à¤¨" à¤Ÿà¥ˆà¤¬ à¤®à¥‡à¤‚ à¤œà¤¾à¤à¤‚ â€” AI à¤†à¤ªà¤•à¤¾ à¤ªà¥‚à¤°à¤¾ à¤Ÿà¥ˆà¤•à¥à¤¸ à¤ªà¥à¤²à¤¾à¤¨ à¤¬à¤¨à¤¾à¤à¤—à¤¾!</div></div>';
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SCANNER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function openScan(){ document.getElementById('scanModal').style.display='flex'; }
function closeScan(){ document.getElementById('scanModal').style.display='none'; }
function runScan(){
  var f=document.getElementById('scanFile').files[0]; if(!f) return;
  var prog=document.getElementById('scanProg'); prog.style.display='block';
  document.getElementById('scanOut').innerHTML='';
  speak('AI à¤¸à¥à¤•à¥ˆà¤¨à¤¿à¤‚à¤— à¤¶à¥à¤°à¥‚à¥¤');
  var steps=[{p:25,t:'à¤šà¤¿à¤¤à¥à¤° processingâ€¦'},{p:55,t:'OCR text à¤ªà¤¹à¤šà¤¾à¤¨â€¦'},{p:80,t:'AI data extractâ€¦'},{p:100,t:'à¤ªà¥‚à¤°à¥à¤£! âœ…'}];
  var i=0, bar=document.getElementById('scanBar'), txt=document.getElementById('scanTxt');
  var tmr=setInterval(function(){ if(i<steps.length){ bar.style.width=steps[i].p+'%'; txt.textContent=steps[i].t; i++; } else clearInterval(tmr); },550);
  setTimeout(function(){
    prog.style.display='none';
    var type=document.getElementById('docType').value;
    var res={auto:'PAN: ABCDE1234F | à¤¨à¤¾à¤®: à¤°à¤®à¥‡à¤¶ à¤•à¥à¤®à¤¾à¤° | DOB: 15/08/1985',pan:'PAN: ABCDE1234F | à¤¨à¤¾à¤®: à¤°à¤®à¥‡à¤¶ à¤¶à¤°à¥à¤®à¤¾',aadhaar:'à¤†à¤§à¤¾à¤°: 1234 5678 9012 | à¤¨à¤¾à¤®: à¤ªà¥à¤°à¤¿à¤¯à¤¾ à¤¸à¤¿à¤‚à¤¹',gst:'GSTIN: 27ABCDE1234F1Z5 | Business: Sharma Enterprises',invoice:'INV-2024-0156 | à¤°à¤¾à¤¶à¤¿: â‚¹59,000 | Date: 15/02/2024',bank:'HDFC | Acc: 1234567890 | Balance: â‚¹1,45,000'};
    document.getElementById('scanOut').innerHTML='<div class="ibox" style="border-color:var(--green);background:#0a2e1a;color:var(--green)"><div style="font-weight:800;margin-bottom:5px">âœ… AI à¤¨à¤¿à¤·à¥à¤•à¤°à¥à¤·à¤£ à¤¸à¤«à¤²!</div><div style="font-size:12px">'+res[type]+'</div><div style="margin-top:10px;display:flex;gap:7px"><button class="btn green sm" onclick="closeScan()">âœ… à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¥‡à¤‚</button><button class="btn gray sm" onclick="closeScan()">âŒ à¤°à¤¦à¥à¤¦</button></div></div>';
    speak('à¤¸à¥à¤•à¥ˆà¤¨ à¤ªà¥‚à¤°à¥à¤£à¥¤');
  },2400);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   UTILS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function fmt(n){ return Number(n).toLocaleString('en-IN'); }
function set(id,v){ var e=document.getElementById(id); if(e) e.textContent=v; }
function esc(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   INIT â€” runs once on load
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
window.addEventListener('DOMContentLoaded', function(){
  initVox();
  initRec();
  loadInvC();
  refreshDash();
  renderClients();
  renderInvest();
  renderCal();

  // Set today's date as default for invoice
  var td = new Date().toISOString().split('T')[0];
  var id = document.getElementById('iDate'); if(id) id.value=td;
  var id2 = document.getElementById('invDt'); if(id2) id2.value=td;

  // Invoice number auto
  document.getElementById('iNum').value = 'INV-'+String(DB.invoices.length+1).padStart(4,'0');

  // First item in invoice
  addItem();

  // Welcome
  setTimeout(function(){
    banner('ğŸ™ CA Sourabh Bandi Software à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤! ğŸ—£ï¸ à¤Ÿà¥‡à¤¸à¥à¤Ÿ à¤¬à¤Ÿà¤¨ à¤¸à¥‡ à¤†à¤µà¤¾à¤œà¤¼ check à¤•à¤°à¥‡à¤‚à¥¤');
  }, 500);
});
</script>
</body>
</html>
